var EZFC;EZFC_Object=function($){var O=this,l="__HIDDEN__";this.init=function(){"undefined"==typeof EZFC_LOADED&&(EZFC_LOADED=!0,this.form_vars=[],this.$form_elements=[],this.$element_trigger=0,this.trigger_list=[],this.subtotals=[],this.conditional_once=[],this.payment_form_id=0,this.payment_methods=["stripe","authorize"],this.elements_cache=[],this.group_repeat_elements=[],this.uploaded_files=[],this.skip_init_blur_classes=["ezfc-slider","ezfc-spinner"],this.current_steps=[],this.functions={calculate_element:function(e,t){return O.calculate_element(e,t)},calculate_price:function(e){var t=$(".ezfc-form[data-id='"+e+"']");return O.calculate_price(t)},get_calculated_value_from:function(e,t){return O.get_calculated_element_value(e,t)},get_element_id_by_name:function(e,t){return e||(e=$(".ezfc-form [data-elementname='"+t+"']").closest(".ezfc-form").data("id")),t=t.toLowerCase(),void 0===O.elements_cache[e][t]&&(O.elements_cache[e][t]=$("#ezfc-form-"+e+" .ezfc-element[data-elementname='"+t+"']")),!!O.elements_cache[e][t].length&&O.elements_cache[e][t].data("id")},get_selected_id:function(e){var t;if("number"==typeof e)t=e;else{if("string"!=typeof e)return O.debug_message("Unknown object type: "+e),!1;if(!(t=O.functions.get_element_id_by_name(null,e)))return O.debug_message("Unknown element: "+e),!1}var a=O.functions.get_value_from(t,!0,!0,{return_value:"option_id"});return 1==a.length?a[0]:O.functions.get_value_from(t,!0,!0,{return_value:"option_id"})},get_value_from:function(e,t,a,i){return O.get_value_from_element(null,e,t,a,i)},get_value_from_name:function(e,t,a){var i=O.functions.get_element_id_by_name(e,t);return O.functions.get_value_from(i,a)},price_format:function(e,t,a,i,r){return O.format_price(e,t,a,i,r)}},ezfc_functions=this.functions,this.external_listeners=[],this.price_old_global=[],numeral.register("locale","ezfc",{delimiters:{decimal:ezfc_vars.price_format_dec_point,thousands:ezfc_vars.price_format_dec_thousand},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),numeral.locale("ezfc"),this.defaultFormat=ezfc_vars.price_format?ezfc_vars.price_format:"0,0[.]00",numeral.defaultFormat(this.defaultFormat),$.datepicker.setDefaults($.datepicker.regional[ezfc_vars.datepicker_language]),this.attach_events(),this.init_tips())},this.attach_events=function(){$(document).on("click",".ezfc-element-option-image",function(){$(this).hasClass("ezfc-element-radio-image")?O.radio_change_state($(this).siblings(".ezfc-element-radio-input")):$(this).hasClass("ezfc-element-checkbox-image")&&O.checkbox_change_state($(this).siblings(".ezfc-element-checkbox-input"))}),$(document).on("click",".ezfc-element-option-has-image label",function(){var e=$(this).closest(".ezfc-element").data("element"),t=$(this).closest(".ezfc-element-single-option-container").find(":input");"radio"==e?O.radio_change_state(t):"checkbox"==e&&O.checkbox_change_state(t,null,!1,!0)}),$(".ezfc-addon-option").click(function(){$(this).siblings(".ezfc-element-option-image").click()}),$(".ezfc-form").each(function(){var e=$(this),t=e.closest(".ezfc-wrapper");O.init_form(e),O.init_form_ui(e),t.find(".ezfc-form-loading-text").length&&t.find(".ezfc-form-loading-text").fadeOut(500,function(){e.fadeIn(500,function(){t.removeClass("ezfc-form-loading"),O.form_change(e),O.scroll()})}),$(document).trigger("ezfc_forms_loaded")}),$(".ezfc-element-fileupload").each(function(e,a){var r=$(this).closest(".ezfc-element"),n=r.find(".ezfc-upload-button"),s=r.find(".ezfc-fileupload-files"),o=r.data("id"),t=($(this).attr("multiple"),$(this).closest(".ezfc-form")),c=t.find("input[name='id']").val(),l=t.find("input[name='ref_id']").val(),i={action:"ezfc_frontend_fileupload",data:"action=upload_file&id="+c+"&ref_id="+l};if("function"!=typeof $.prototype.fileupload)return O.debug_message("Unable to load fileupload function."),!1;$(this).fileupload({formData:i,dataType:"json",add:function(e,t){r.find(".ezfc-bar").css("width",0),r.find(".progress").addClass("active"),r.find(".ezfc-fileupload-message").text(""),n.off("click"),n.click(function(){return""==$(a).val()||(t.files=t.originalFiles,t.submit(),$(n).attr("disabled","disabled"),e.preventDefault()),!1})},done:function(e,t){if(n.removeAttr("disabled"),t.result.error)return r.find(".ezfc-fileupload-message").text(t.result.error),r.find(".ezfc-bar").css("width",0),!1;for(var a in void 0===O.uploaded_files[c]&&(O.uploaded_files[c]=[]),void 0===O.uploaded_files[c][o]&&(O.uploaded_files[c][o]=[]),t.result)O.uploaded_files[c][o].push({id:t.result[a].success,name:t.files[a].name});$(this).val(""),$(this).attr("multiple")||$(this).attr("disabled","disabled"),r.find(".progress").removeClass("active"),r.find(".ezfc-fileupload-message").text(ezfc_vars.upload_success);var i="";for(var a in O.uploaded_files[c][o])i+="<li class='ezfc-fileupload-files-item' data-fileid='"+O.uploaded_files[c][o][a].id+"' data-refid='"+l+"'>"+O.uploaded_files[c][o][a].name+" <span class='ezfc-fileupload-files-remove'><i class='fa fa-close'></i></span></li>";s.html(i)},progressall:function(e,t){var a=parseInt(t.loaded/t.total*100,10);$(r).find(".ezfc-bar").css("width",a+"%")},replaceFileInput:!1,url:ezfc_vars.ajaxurl})}),$(document).on("click",".ezfc-fileupload-files-remove",function(){var i=$(this);if(i.hasClass("ezfc-state-removing"))return!1;var r=i.closest(".ezfc-form").find("input[name='id']").val(),n=i.closest(".ezfc-element"),s=i.closest(".ezfc-fileupload-files-item"),o=n.find(".ezfc-fileupload-message"),c=n.find(".ezfc-element-fileupload"),l=n.data("id"),d=s.data("fileid"),e=s.data("refid"),t="action=remove_uploaded_file&file_id="+d+"&ref_id="+e;return i.addClass("ezfc-state-removing"),i.find(".fa").removeClass("fa-close").addClass("fa-circle-o-notch fa-spin"),$.ajax({type:"post",url:ezfc_vars.ajaxurl,data:{action:"ezfc_frontend_fileupload",data:t},complete:function(e){var t;if("object"==typeof e&&void 0!==e.responseText)try{t=$.parseJSON(e.responseText)}catch(e){}if(!t)return o.text(e.upload_remove_error),i.find(".fa").removeClass("fa-circle-o-notch fa-spin ezfc-state-removing").addClass("fa-close"),!1;c.attr("multiple")||1==n.find(".ezfc-fileupload-files-item").length&&c.removeAttr("disabled");for(var a in s.fadeOut(),o.text(ezfc_vars.upload_removed),O.uploaded_files[r][l])O.uploaded_files[r][l][a].id==d&&O.uploaded_files[r][l].splice(a,1)}}),!1}),$(".ezfc-overview").dialog({autoOpen:!1,modal:!0}),$(".ezfc-form .ezfc-input-format-listener").each(function(){O.input_format_listener_change($(this)),$(this).trigger("ezfc_blur_trigger")});var e=this.throttle(function(e){var t=e.parents(".ezfc-form");O.form_change(t,null,e)},100);$(document).on("change keyup",".ezfc-form input, .ezfc-form select",function(){e($(this))}),$(".ezfc-element-wrapper-checkbox").change(function(){O.checkbox_change($(this))}),$(document).on("click",".ezfc-element-wrapper-radio :input",function(){O.radio_change_state($(this),!0)}),$(".ezfc-slider").each(function(e,t){var r=$(this),i=$(this).data("id"),n=$(this).closest(".ezfc-form").data("id"),a=$(t).siblings(".ezfc-slider-element"),s=r.hasClass("ezfc-slider-vertical")?"vertical":"horizontal",o=O.normalize_value(r.val(),r),c={min:r.data("min")||0,max:r.data("max")||100,step:r.data("stepsslider")||1,value:o||0,orientation:s},l=r.data("values"),d=null;l&&(d=l.split(","),d=$.map(d,$.trim),c.min=0,c.max=d.length-1),c.slide=function(e,t){var a=t.value;d&&void 0!==d[t.value]&&(a=d[t.value]);var i=O.format_price(n,a,!1,!1,!1,!0);r.val(i),r.trigger("change")},c.start=function(e,t){r.trigger("focus")},c.stop=function(e,t){t.value;d&&void 0!==d[t.value]&&d[t.value];var a=O.format_value_element(i,t.value);r.val(a),r.trigger("change"),r.trigger("blur")};var _=a.slider(c);if($(document).on("change keyup",r,function(){var e=O.normalize_value(r.val(),r),t=e;if(d)for(var a in d){O.normalize_value(e,r);e==d[a]&&(t=a)}_.slider("value",t)}),r.hasClass("ezfc-pips")){var f={rest:"label"};d&&(f.labels=d),isNaN(r.data("stepspips"))||""==r.data("stepspips")||(f.step=r.data("stepspips")),a.slider("pips",f),a.find(".ui-slider-pip").on("click",function(){var e=$(this).find(".ui-slider-label").data("value");d&&void 0!==d[e]&&(e=d[e]),e=O.format_price(n,e,!1,!1,!1,!0),r.val(e),r.trigger("change")}),1==r.data("pipsfloat")&&a.slider("float")}}),$(".ezfc-spinner").each(function(e,t){var r=$(this),n=$(this).data("id"),a=$(this).closest(".ezfc-form").data("id");r.data("stepsspinner");r.spinner({min:r.data("min")||0,max:r.data("max")||100,step:r.data("stepsspinner")||1,change:function(e,t){},spin:function(e,t){O.format_price(a,t.value,!1,!1,!1,!1)},start:function(e,t){var a=r.val(),i=O.normalize_value(a);r.val(i)},stop:function(e,t){var a=r.val();a=O.normalize_value(a,$(this));var i=O.format_value_element(n,a);r.val(i),r.trigger("change")}})}),$(document).on("click",".ezfc-step-button",function(){var e=$(this).parents(".ezfc-form"),t=parseInt(e.find(".ezfc-step-active").data("step"))+($(this).hasClass("ezfc-step-next")?1:-1),a=$(this).hasClass("ezfc-step-next")?1:0;return O.set_step(e,t,a),!1}),$(document).on("click",".ezfc-step-indicator-item-active",function(){var e=$(this).closest(".ezfc-form"),t=parseInt($(this).data("step"));return O.set_step(e,t,0),!1}),$(document).on("change",".ezfc-element-wrapper-payment input",function(){var e=$(this).closest(".ezfc-form"),t=e.data("id");1!=O.form_vars[t].price_show_request&&1!=O.form_vars[t].summary_enabled&&O.set_submit_text(e)}),$(window).scroll(this.scroll),this.scroll(),$(".ezfc-form").submit(function(e){var t=$(this),a=t.data("id"),i=t.find(".ezfc-submit");return 1==O.form_vars[a].hard_submit||(O.form_submit(t,-1,i.data("type")),e.preventDefault(),!1)}),$(".ezfc-payment-submit").click(function(e){var t=$(this).closest(".ezfc-payment-form").data("form_id"),a=$(".ezfc-form[data-id='"+t+"']");return O.form_submit(a,-1,$(this).data("payment")),e.preventDefault(),!1}),$(".ezfc-payment-cancel").click(function(){var e=$(this).closest(".ezfc-payment-form").data("form_id"),t=$("#ezfc-form-"+e),a=".ezfc-payment-dialog-modal[data-form_id='"+e+"']";return $(a+=", .ezfc-payment-form").removeClass("ezfc-payment-dialog-open"),O.form_submit(t,!1,!1,!0),!1}),$(".ezfc-reset").click(function(){var e=$(this).parents(".ezfc-form");return O.reset_form(e),!1}),$(".ezfc-collapse-title-wrapper").on("click",function(){var e=$(this).closest(".ezfc-element-wrapper-group");O.toggle_group(e)}),$(".ezfc-cc-number-formatter").on("change keyup",function(){var e=$(this).val();e=e.replace(/[^\dA-Z]/g,"").replace(/(.{4})/g,"$1 ").trim(),$(this).val(e)}),$(".ezfc-table_order-btn").on("click",function(){var e=$("#"+$(this).data("target"));if(e.is(":disabled"))return!1;var t=e.closest(".ezfc-custom-element").closest(".ezfc-form").data("id"),a=e.data("min"),i=e.data("max"),r=$(this).data("value"),n=O.normalize_value(e.val())+r;return 0==i&&(i=n),n=Math.min(n,i),n=Math.max(n,a),n=O.format_price(t,n,!1,!1,!1,!0),e.val(n),e.trigger("blur"),O.form_change(null,t),!1}),$(".ezfc-element-table_order-quantity-input").on("blur",function(){var e=$(this).closest(".ezfc-custom-element").closest(".ezfc-form").data("id"),t=$(this).data("min"),a=$(this).data("max"),i=O.normalize_value($(this).val());0==a&&(a=i),i=Math.min(i,a),i=Math.max(i,t),i=O.format_price(e,i,!1,!1,!1,!0),$(this).val(i),O.form_change(null,e)}),$(".ezfc-group-repeat").on("click",function(){return O.group_repeat($(this).data("group_repeat_id")),!1}),$(".ezfc-form-open-popup-button").click(function(){var e=$(this).data("target");return O.popup_form_open(e),!1}),$(".ezfc-form-popup-close").click(function(){var e=$(this).data("target");return O.popup_form_close(e),!1})},this.init_form_ui=function(e,t){void 0===t&&(t=!0);var i=$(e),o=i.data("id");i.find(".ezfc-element-datepicker").each(function(){var e=$(this),t={};e.data("settings")&&(t=e.data("settings"));var i=[0,1,2,3,4,5,6];t.available_days.length&&(i=t.available_days.split(",")),i=i.map(function(e){return parseInt(e)});var r=[];t.blocked_days.length&&(r=t.blocked_days.split(","));var a=$.trim(O.form_vars[o].datepicker_format);""==a&&(a="dd/mm/yy");var n=$.trim(t.yearRange);""==n&&(n="c-10:c+10"),e.datepicker({changeMonth:!!t.changeMonth&&t.changeMonth,changeYear:!!t.changeYear&&t.changeYear,dateFormat:a,firstDay:!!t.firstDay&&t.firstDay,minDate:t.minDate?t.minDate:"",maxDate:t.maxDate?t.maxDate:"",numberOfMonths:t.numberOfMonths?parseInt(t.numberOfMonths):1,showAnim:t.showAnim?t.showAnim:"fadeIn",showWeek:"1"==t.showWeek&&t.showWeek,yearRange:n,beforeShowDay:function(e){return O.check_datepicker_days(e,i,r)}}),e.on("change keyup",function(){var e=$(this).datepicker("getDate"),t=O.check_datepicker_days(e,i,r),a=!0;"object"!=typeof t||t[0]||(a=!1),a||$(this).val("")}),O.check_datepicker_predefined_values(e)}),i.find(".ezfc-element-daterange").each(function(){var n=$(this),e=n.closest(".ezfc-element-daterange-container").data("settings"),t=[0,1,2,3,4,5,6];e.available_days.length&&(t=e.available_days.split(",")),t=t.map(function(e){return parseInt(e)});var a=[];e.blocked_days.length&&(a=e.blocked_days.split(","));var s=$.trim(O.form_vars[o].datepicker_format);""==s&&(s="dd/mm/yy");var i=$.trim(e.yearRange);""==i&&(i="c-10:c+10"),n.hasClass("ezfc-element-daterange-from")?n.datepicker({changeMonth:!!e.changeMonth&&e.changeMonth,changeYear:!!e.changeYear&&e.changeYear,dateFormat:s,firstDay:!!e.firstDay&&e.firstDay,minDate:n.data("mindate"),maxDate:n.data("maxdate"),numberOfMonths:e.numberOfMonths?parseInt(e.numberOfMonths):1,showAnim:e.showAnim?e.showAnim:"fadeIn",showWeek:"1"==e.showWeek&&e.showWeek,yearRange:i,onSelect:function(e){var t=n.data("mindays")||0,a=n.data("maxdays")||0,i=$.datepicker.parseDate(s,e);i.setDate(i.getDate()+t);var r=$.datepicker.parseDate(s,e);r.setDate(r.getDate()+a),n.siblings(".ezfc-element-daterange-to").datepicker("option","minDate",i),0!=a&&n.siblings(".ezfc-element-daterange-to").datepicker("option","maxDate",r),n.trigger("change")},beforeShowDay:function(e){return O.check_datepicker_days(e,t,a)}}):n.datepicker({changeMonth:!!e.changeMonth&&e.changeMonth,changeYear:!!e.changeYear&&e.changeYear,dateFormat:s,firstDay:!!e.firstDay&&e.firstDay,minDate:n.data("mindate"),maxDate:n.data("maxdate"),numberOfMonths:e.numberOfMonths?parseInt(e.numberOfMonths):1,showAnim:e.showAnim?e.showAnim:"fadeIn",showWeek:"1"==e.showWeek&&e.showWeek,yearRange:i,onSelect:function(e){n.trigger("change")},beforeShowDay:function(e){return O.check_datepicker_days(e,t,a)}}),O.check_datepicker_predefined_values(n)}),i.find(".ezfc-element-timepicker").each(function(){O.init_timepicker($(this),o)}),i.find(".ezfc-element-colorpicker").each(function(){var t=$(this),a=t.parents(".ezfc-element").find(".ezfc-element-colorpicker-input"),e=t.colorpicker({container:t}).on("changeColor.colorpicker",function(e){t.css("background-color",e.color.toHex()),a.val(e.color.toHex())});$(a).on("click focus",function(){e.colorpicker("show")}).on("change",function(){e.colorpicker("setValue",i.val())})});var a=i.find(".ezfc-step");if(0<a.length){var r=a.last();i.find(".ezfc-summary-wrapper").appendTo(r),i.find(".ezfc-submit-wrapper").appendTo(r).addClass("ezfc-submit-step"),this.prevent_enter_step_listener(r.find("input"),i)}O.init_form(e)},this.init_timepicker=function(e,t,a){var i={};e.data("settings")&&(i=e.data("settings")),"object"==typeof a&&(i=$.extend({},i,a));var r=i.format?i.format:O.form_vars[t].timepicker_format;""==r&&(r="H:i"),e.timepicker({disableTimeRanges:i.disabledTimes?i.disabledTimes:[],minTime:i.minTime?i.minTime:null,maxTime:i.maxTime?i.maxTime:null,step:i.steps?i.steps:30,timeFormat:r})},this.init_form=function(e){var t=$(e),i=t.data("id");if(this.form_vars[i]=t.data("vars"),"object"!=typeof this.form_vars[i]&&(this.form_vars[i]=$.parseJSON(t.data("vars"))),$.each(O.form_vars[i].form_elements_order,function(e,t){var a={$element:$("#ezfc_element-"+O.form_vars[i].form_elements_order[e]),$element_input:$("#ezfc_element-"+O.form_vars[i].form_elements_order[e]).find("input"),id:t,form_id:i};O.$form_elements[t]=a}),this.subtotals[i]=[],this.conditional_once[i]=[],this.external_listeners[i]=[],this.elements_cache[i]=[],this.current_steps[i]=0,this.trigger_list[i]=[],1==this.form_vars[i].price_show_request&&this.price_request_toggle(i,!1),this.set_price(t),this.set_submit_text(t),this.form_vars[i].use_woocommerce){$(".woocommerce form.cart, .woocommerce .price").hide()}1<parseInt(this.form_vars[i].step_indicator_start)+1&&t.find(".ezfc-step-indicator").hide(),2!=ezfc_vars.debug_mode||$("#ezfc-show-all-elements").length||(t.append("<button id='ezfc-show-all-elements'>Show/hide elements</button>"),$("#ezfc-show-all-elements").click(function(){return t.hasClass("ezfc-debug-visible")?(t.removeClass("ezfc-debug-visible"),t.find(".ezfc-tmp-visible").removeClass("ezfc-tmp-visible").hide()):(t.addClass("ezfc-debug-visible"),t.find(".ezfc-hidden").addClass("ezfc-tmp-visible").show().css("display","inline-block")),!1})),1==this.form_vars[i].use_stripe&&"undefined"!=typeof Stripe&&Stripe.setPublishableKey(ezfc_vars.stripe.publishable_key),this.prevent_enter_step_listener(":input:not(textarea):not([type=submit])",t),this.populate_html_placeholders(t),1==this.form_vars[i].popup_open_auto&&this.popup_form_open(i),$(document).trigger("ezfc_form_init",i)},this.form_change=function(e,t,a){e=e||$("#ezfc-form-"+t),t=t||$(e).data("id"),this.trigger_list[t]=[];var i=0;if(this.$element_trigger=a){i=a.data("id"),a.hasClass("ezfc-custom-element")||(i=a.closest(".ezfc-custom-element").data("id"));var r=this.get_element_object(i);if(r.trigger_ids.length<1)return;this.form_build_trigger_list(t,r.id)}this.clear_hidden_values(e),this.form_vars[t].price_requested=0,this.form_vars[t].summary_shown=0,$(e).find(".ezfc-summary-wrapper").fadeOut(),1==this.form_vars[t].price_show_request&&this.price_request_toggle(t,!1),this.remove_debug_info(),this.set_price(e),this.set_submit_text(e),this.populate_html_placeholders(e),this.live_summary_update(t),this.call_hook("ezfc_after_form_change",{form_id:t})},this.form_build_trigger_list=function(e,t){var a=this.get_element_object(t),i=[t];$.each(a.trigger_ids,function(e,t){var a=O.get_element_object(t);i=i.concat(a.trigger_ids)}),this.trigger_list[e]=this.unique(i)},this.form_submit=function(m,p,e,t){var h=$(m),v=h.closest(".ezfc-wrapper"),g=h.data("id"),r=!1;h.find(".ezfc-submit-icon").addClass("ezfc-submit-icon-show");var b=h.find(".ezfc-submit-icon, .ezfc-step-submit-icon"),z=h.find("input[type='submit']");if(1==this.form_vars[g].price_show_request&&this.set_price(m),t)return O.submit_cancel(h),!1;if(-1!==$.inArray(e,O.payment_methods)){var a=$("#ezfc-"+e+"-form-"+g),i=this.format_price(g,this.price_old_global[g],!1,!1,!0);if(a.find(".ezfc-payment-price").text(i),O.form_vars[g].payment_info_shown[e]){if(O.payment_form_id=g,a.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!0),"stripe"==e)Stripe.card.createToken(a,this.stripe_response_handler);else if("authorize"==e){if("undefined"==typeof Accept)return O.debug_message("AcceptJS wasn't loaded."),!1;this.authorize_create_token(g)}}else O.form_vars[g].payment_info_shown[e]=1,$("#ezfc-"+e+"-form-"+g+", #ezfc-"+e+"-form-modal-"+g).addClass("ezfc-payment-dialog-open");return b.fadeOut(),!1}for(var n in b.fadeIn(),z.prop("disabled",!0),h.find(".ezfc-custom-hidden:not(.ezfc-element-wrapper-fileupload):not(.ezfc-element-wrapper-group)").each(function(){var e=$(this).find(".ezfc-element-radio:not(:has(:radio:checked))");e.length&&$(e).first().find("input").prop("checked",!0),$(this).find("option").first().prop("checked",!0).val(l),$(this).find(".ezfc-element-checkbox-input").first().prop("checked",!0).addClass("ezfc-has-hidden-placeholder").val(l),$(this).find(":input").val(l).removeAttr("disabled").addClass("ezfc-has-hidden-placeholder")}),ezfc_vars.element_vars[g]){var s=ezfc_vars.element_vars[g][n].id;if(0==this.get_element_object_value(s,"calculate_enabled",1)&&!O.element_is_visible(s))this.get_element_child_input_dom(s).val(l)}h.find(".ezfc-element-wrapper-checkbox").each(function(){if($(this).find(".ezfc-has-hidden-placeholder").length)return!1;var e=$(this),t=parseInt(e.attr("data-min_selectable")),a=parseInt(e.attr("data-max_selectable")),i=e.find(":checked").length;return 0<t&&i<t?(r=!0,O.show_tip(e,"#"+e.attr("id"),0,O.sprintf(O.form_vars[g].selectable_min_error,t)),!1):0<a&&a<i?(r=!0,O.show_tip(e,"#"+e.attr("id"),0,O.sprintf(O.form_vars[g].selectable_max_error,a)),!1):void 0});var o=[];h.find("[data-is_number='1'] input").each(function(){this.value!=l&&(o.push({element:$(this),value:this.value}),this.value=this.value.replace(/[^0-9\.,-]/g,""))});var y=h.serialize();if($.each(o,function(e,t){$(t.element).val(t.value)}),r)return b.fadeOut(),z.removeAttr("disabled"),!1;$(".ezfc-element[data-min], .ezfc-element[data-max]").each(function(){var e=$(this).closest(".ezfc-custom-element").data("id"),t=$(this).data("min"),a=$(this).data("max"),i="&dynamic_min["+e+"]="+t;y+=i+="&dynamic_max["+e+"]="+a}),y+="&url="+encodeURI(window.location.href),0==this.form_vars[g].price_requested&&(y+="&price_requested=1"),0==this.form_vars[g].summary_shown&&(y+="&summary=1"),-1!=p&&(y+="&step="+p),this.form_vars[g].preview_form&&(y+="&preview_form="+this.form_vars[g].preview_form);var c=this.price_old_global[g];1==this.form_vars[g].price_show_request&&(c=O.functions.calculate_price(g)),y+="&generated_price="+c,this.call_hook("ezfc_before_submission",{data:y,form:h,form_vars:this.form_vars[g],id:g}),$.ajax({type:"post",url:ezfc_vars.ajaxurl,data:{action:"ezfc_frontend",data:y},success:function(t){$(".ezfc-submit-icon").removeClass("ezfc-submit-icon-show"),z.removeAttr("disabled"),b.fadeOut(),O.debug_message(t);try{t=$.parseJSON(t)}catch(e){t=!1,O.debug_message(e)}if(!t)return $("#ezfc-message-"+g).text(ezfc_vars.form_submit_error),O.recaptcha_reload(),O.reset_disabled_fields(m,!0),!1;if(void 0!==t.error){if(O.reset_disabled_fields(m,!0),t.id){var e=!0,a="#ezfc_element-"+t.id,i=$(a).find(".ezfc-element").first(),r=0<h.find(".ezfc-step-active").length;if(r)parseInt($(a).parents(".ezfc-step").data("step"))!=p&&-1!=p&&(e=!1,O.set_step(m,p+1));if(e){i.length||(i=$(a));var n=r?1e3:400,s=0<v.find(".ezfc-payment-dialog-open").length;if(i.is(":visible"))O.show_tip(i,a,n,t.error),s&&O.set_message(g,t.error+" (#"+t.id+")");else{var o=i.parents(".ezfc-element-wrapper-group");o.length?(o.each(function(e,t){O.toggle_group($(t),!0)}),O.show_tip(i,a,n,t.error)):O.set_message(g,t.error+" (#"+t.id+")")}if(void 0!==ezfc_vars.required_text_auto_hide){var c=1e3*parseFloat(ezfc_vars.required_text_auto_hide);0<c&&setTimeout(function(){null},c)}0==O.form_vars[g].disable_error_scroll&&O.scroll_to(a)}}else O.set_message(g,t.error);return O.recaptcha_reload(),!1}if(t.step_valid)return O.reset_disabled_fields(m),O.set_step(m,p+1),!1;if(t.summary)return h.find(".ezfc-summary-wrapper").fadeIn().find(".ezfc-summary").html(t.summary),O.form_vars[g].summary_shown=1,O.reset_disabled_fields(m),!1;if(O.recaptcha_reload(),t.paypal)z.attr("disabled","disabled"),window.location.href=t.paypal;else{if(t.price_requested||0===t.price_requested)return O.price_request_toggle(g,!0,t.price_requested),!1;var l={data:y,form:h,form_vars:O.form_vars[g],id:g,price:price,response:t};O.call_hook("ezfc_submission_success",l),O.form_vars[g].submission_js_func&&"function"==typeof window[O.form_vars[g].submission_js_func]&&window[O.form_vars[g].submission_js_func](l),v.find(".ezfc-payment-dialog, .ezfc-payment-dialog-modal").removeClass("ezfc-payment-dialog-open");var d=$(".ezfc-success-text[data-id='"+g+"']");if(d.html(t.success),1==O.form_vars[g].reset_after_submission)return O.reset_form(m),void d.fadeIn().delay(7500).fadeOut();if(1==O.form_vars[g].hide_all_forms?$(".ezfc-form, .ezfc-required-notification").fadeOut():(h.find(".ezfc-required-notification").fadeOut(),1==O.form_vars[g].show_success_text&&h.fadeOut()),1==O.form_vars[g].show_success_text&&(1==O.form_vars[g].scroll_to_success_message?d.fadeIn(400,function(){O.scroll_to(d,-200)}):d.fadeIn()),t.woo_update_cart&&t.woo_cart_html&&0<ezfc_vars.woocommerce_update_cart_selector.length&&$(ezfc_vars.woocommerce_update_cart_selector).html(t.woo_cart_html),void 0!==O.form_vars[g].redirect_url&&0<O.form_vars[g].redirect_url.length){var _="";1==O.form_vars[g].redirect_forward_values&&(_=h.serialize(),_+="&total="+O.price_old_global[g],_+="&total_f="+O.functions.price_format(g,O.price_old_global[g]));var f=-1==O.form_vars[g].redirect_url.indexOf("?")?"?":"&";window.location.href=O.form_vars[g].redirect_url+f+_}else if(void 0!==O.form_vars[g].refresh_page_after_submission&&1==O.form_vars[g].refresh_page_after_submission){var u=Math.max(0,Math.abs(parseInt(O.form_vars[g].redirect_timer)));setTimeout(function(){window.location.reload()},1e3*u)}}}}).fail(function(e,t,a){return O.debug_message({jqXHR:e,testStatus:t,errorThrown:a}),O.set_message(g,ezfc_vars.form_submit_error),O.submit_cancel(h),!1})},this.calculate_get_external_values=function(e,t,a,i){var r,n=a.data("value_external"),s=a.data("value_external_listen");this.external_listeners[t][n]&&!s||n&&0<$(n).length&&(r=$(n).is("input[type='radio']")?$(n).find(":checked").val():$(n).is("input, input[type='text'], textarea")?$(n).val():$(n).is("select")?$(n).find(":selected").text():$(n).text(),"input"==i||"numbers"==i||"subtotal"==i?a.find("input").val(r):"dropdown"==i?(a.find(":selected").removeAttr("selected"),a.find("option[value='"+r+"']").attr("selected","selected")):"radio"==i?(a.find(":checked").removeAttr("checked"),a.find("input[value='"+r+"']").attr("checked","checked")):"checkbox"==i?(a.find(":checked").removeAttr("checked"),a.find("input[value='"+r+"']").attr("checked","checked")):"textfield"==i&&a.find("textarea").val(r),this.external_listeners[t][n]||(this.external_listeners[t][n]=1,$(n).on("change keyup",function(){O.set_price($(e))})))},this.calculate_conditionals=function(e,_,f,u){var m=this.get_element_object(f),p=this.get_element_dom(f);if(f&&void 0!==m.conditional){var h=m.conditional,v=this.get_value_from_element(p,null,0==m.is_number),t=this.get_element_object_value(m,"factor",1);for(var g in h.action){var a=h.action[g];if(a&&0!=a){var b,i=h.target[g];O.get_element_object(i);if((b="submit_button"==h.target[g]?$(e).find(".ezfc-submit"):"price"==h.target[g]?$(e).find(".ezfc-price-wrapper-element"):O.get_element_dom(i))&&!(b.length<1&&h.redirects.length<1)){1==h.use_factor[g]&&(t=parseFloat(t),isNaN(t)||(v*=t));var r=[{operator:h.operator[g],value:h.values[g],compare_target:""}];void 0!==h.chain&&void 0!==h.chain[g]&&(h.chain[g].operator,1)&&$.each(h.chain[g].operator,function(e,t){r.push({operator:h.chain[g].operator[e],value:h.chain[g].value[e],compare_target:h.chain[g].compare_target[e]})});var n,s,z=!1,y=0;$.each(r,function(e,t){var a=!1,i=t.value,r=[],n=v;0!=t.compare_target&&""!=t.compare_target&&(n=O.get_value_from_element(!1,t.compare_target)),"__self__"==t.value&&(t.value=v);if(i=1==m.is_number&&-1===$.inArray(t.operator,["in","not_in","selected","not_selected","selected_index","not_selected_index","selected_id","not_selected_id","selected_count","not_selected_count"])?parseFloat(t.value):t.value,"between"!=t.operator&&"not_between"!=t.operator||1<(r=t.value.split(":")).length&&(r[0]=parseFloat(r[0]),r[1]=parseFloat(r[1])),"input"==u)a=i.toLowerCase()==b.val().toLowerCase();else switch(t.operator){case"gr":a=i<n;break;case"gre":a=i<=n;break;case"less":a=n<i;break;case"lesse":a=n<=i;break;case"equals":a=n==i;break;case"between":a=!(r.length<2)&&(n>=r[0]&&n<=r[1]);break;case"not_between":a=!(r.length<2)&&(n<r[0]||n>r[1]);break;case"not":a=r.length<2?n!=i:n<r[0]&&n>r[1];break;case"hidden":a=!O.element_is_visible(f);break;case"visible":a=O.element_is_visible(f);break;case"mod0":a=0<n&&n%i==0;break;case"mod1":a=0<n&&n%i!=0;break;case"bit_and":a=n&i;break;case"bit_or":a=n|i;break;case"empty":void 0===n&&(a=!0),a="number"==typeof n?isNaN(n):n.length<1;break;case"notempty":a=void 0!==n&&("number"==typeof n?!isNaN(n):0<n.length);break;case"in":if(void 0===n)a=!1;else{var s=i.split("|");for(var o in a=!1,s)if(n==s[o])return void(a=!0)}break;case"not_in":if(void 0===n)a=!1;else{s=i.split("|");for(var o in a=!0,s)if(n==s[o])return void(a=!1)}break;case"once":a=!0,void 0===O.conditional_once[_][f]&&(O.conditional_once[_][f]=[]),void 0===O.conditional_once[_][f][g]&&(O.conditional_once[_][f][g]=[]),void 0===O.conditional_once[_][f][g][e]?O.conditional_once[_][f][g][e]=1:a=!1;break;case"selected":case"selected_index":case"selected_id":case"selected_count":case"selected_count_gt":case"selected_count_lt":a=!1;var c="value";if("selected_index"==t.operator?c="index":"selected_id"==t.operator?c="option_id":"selected_count"!=t.operator&&"selected_count_gt"!=t.operator&&"selected_count_lt"!=t.operator||(c="count"),"object"==typeof(d=0!=t.compare_target&&""!=t.compare_target?O.get_value_from_element(!1,t.compare_target,!0,!1,{return_array:!0,return_value:c}):O.get_value_from_element(p,null,!0,!1,{return_array:!0,return_value:c}))){s=i.split("|");for(var o in s)for(var l in cmp_value=s[o],d)d[l]==cmp_value&&(a=!0)}else a="selected_count"==t.operator?d==i:"selected_count_gt"==t.operator?i<d:"selected_count_lt"==t.operator?d<i:d==i;break;case"not_selected":case"not_selected_index":case"not_selected_id":case"not_selected_count":a=!0;var d;c="value";if("not_selected_index"==t.operator?c="index":"not_selected_id"==t.operator?c="option_id":"not_selected_count"==t.operator&&(c="count"),"object"==typeof(d=0!=t.compare_target&&""!=t.compare_target?O.get_value_from_element(!1,t.compare_target,!0,!1,{return_array:!0,return_value:c}):O.get_value_from_element(p,null,!0,!1,{return_array:!0,return_value:c}))){s=i.split("|");for(var o in s)for(var l in cmp_value=s[o],d)if(d[l]==cmp_value)return void(a=!1)}else a=d!=i;break;case"focus":a=0<p.find(".ezfc-slider").length?p.find("input").is(":focus")||0<p.find(".ui-state-active").length:p.find("input").is(":focus");break;case"blur":a=0<p.find(".ezfc-slider").length?!p.find("input").is(":focus")&&p.find(".ui-state-active").length<1:!p.find("input").is(":focus");break;case"always":a=!0;break;case"step_equals":a=O.current_steps[_]==i;break;case"step_gt":a=i<O.current_steps[_];break;case"step_lt":a=O.current_steps[_]<i;break;case"calculate_enabled":a=1==O.get_element_object_value(m,"calculate_enabled",1);break;case"calculate_disabled":a=0==O.get_element_object_value(m,"calculate_enabled",1);break;default:a=!1}if(void 0!==h.row_operator[g]&&1==h.row_operator[g]){if(a)return y++,!(z=!0)}else{if(!a)return;y++}}),0<y&&y==r.length&&(z=!0);var o=h.notoggle[g],c=b.data("element"),l=h.target_value[g];if(l=l.replace(/__self__/gi,v),"group"==c&&b.push($(b).find("> .ezfc-custom-element")),"set"==a&&z){var d=O.check_inline_math(l,b);if("input"==c||"hidden"==c||"numbers"==c||"subtotal"==c||"set"==c)O.set_element_object_value(i,"current_value",d),O.set_element_object_value(i,"current_value_forced",d),b.find("input").val(d).trigger("blur");else if("dropdown"==c)b.find(":selected").removeAttr("selected"),b.find("option[data-value='"+d+"']").prop("selected","selected");else if("radio"==c)O.radio_change_state(b.find("input[data-value='"+d+"']"),!0,!0);else if("checkbox"==c)O.checkbox_change_state(b.find("input[data-value='"+d+"']"),!0,!0);else if("datepicker"==c){(k=b.find("input.hasDatepicker")).length&&k.datepicker("setDate",l)}else if("daterange"==c){var k;if(1<(k=b.find("input.hasDatepicker")).length){var x=l.split(";;");void 0!==x[0]&&$(k[0]).datepicker("setDate",x[0]),void 0!==x[1]&&$(k[1]).datepicker("setDate",x[1])}}else"image"==c?b.find("img").attr("src",l):b.text(d)}else if("set_factor"==a&&z)O.set_element_object_value(i,"factor",l);else if("select_option"==a&&z)"radio"==c?O.radio_change_state(b.find("input[data-optionid='"+l+"']"),!0,!0):"checkbox"==c?O.checkbox_change_state(b.find("input[data-optionid='"+l+"']"),!0,!0):"dropdown"==c&&(b.find(":selected").removeAttr("selected"),b.find("option[data-optionid='"+l+"']").prop("selected","selected"));else if("deselect_option"==a&&z)"radio"==c?O.radio_change_state(b.find("input[data-optionid='"+l+"']"),!1,!0):"checkbox"==c?O.checkbox_change_state(b.find("input[data-optionid='"+l+"']"),!1,!0):"dropdown"==c&&b.find(":selected").removeAttr("selected");else if("show_option"==a)z?"radio"==c||"checkbox"==c?b.find("input[data-optionid='"+l+"']").closest(".ezfc-element-single-option-container").show():"dropdown"==c&&b.find("option[data-optionid='"+l+"']").removeAttr("hidden"):"radio"==c?(O.radio_change_state(b.find("input[data-optionid='"+l+"']"),!1,!0),b.find("input[data-optionid='"+l+"']").closest(".ezfc-element-single-option-container").hide()):"checkbox"==c?(O.checkbox_change_state(b.find("input[data-optionid='"+l+"']"),!1,!0),b.find("input[data-optionid='"+l+"']").closest(".ezfc-element-single-option-container").hide()):"dropdown"==c&&(b.find(":selected").removeAttr("selected"),b.find("option[data-optionid='"+l+"']").attr("hidden",!0));else if("hide_option"==a)z?"radio"==c?(O.radio_change_state(b.find("input[data-optionid='"+l+"']"),!1,!0),b.find("input[data-optionid='"+l+"']").closest(".ezfc-element-single-option-container").hide()):"checkbox"==c?(O.checkbox_change_state(b.find("input[data-optionid='"+l+"']"),!1,!0),b.find("input[data-optionid='"+l+"']").closest(".ezfc-element-single-option-container").hide()):"dropdown"==c&&b.find("option[data-optionid='"+l+"']").attr("hidden",!0).removeAttr("selected"):"radio"==c||"checkbox"==c?b.find("input[data-optionid='"+l+"']").closest(".ezfc-element-single-option-container").show():"dropdown"==c&&b.find("option[data-optionid='"+l+"']").removeAttr("hidden");else if("activate"==a){if(z)if("submit"==c)b.prop("disabled",!1);else if("group"==c){var w=O.get_group_children(i);O.set_element_list_object_value(w,"calculate_enabled",1)}else O.set_element_object_value(i,"calculate_enabled",1);else if(1!=o)if("submit"==c)b.prop("disabled",!0);else if("group"==c){w=O.get_group_children(i);O.set_element_list_object_value(w,"calculate_enabled",0)}else O.set_element_object_value(i,"calculate_enabled",0)}else if("activate_option"==a){var j="[data-optionid='"+h.option_index_value[g]+"']";z?b.find(j).prop("disabled",!1).removeClass("force-disabled"):b.find(j).prop("disabled",!0).addClass("force-disabled")}else if("deactivate"==a){if(z)if("submit"==c)b.prop("disabled",!0);else if("group"==c){w=O.get_group_children(i);O.set_element_list_object_value(w,"calculate_enabled",0)}else O.set_element_object_value(i,"calculate_enabled",0);else if(1!=o)if("submit"==c)b.prop("disabled",!1);else if("group"==c){w=O.get_group_children(i);O.set_element_list_object_value(w,"calculate_enabled",1)}else O.set_element_object_value(i,"calculate_enabled",1)}else if("deactivate_option"==a){var C="[data-optionid='"+h.option_index_value[g]+"']";z?b.find(C).prop("disabled",!0).addClass("force-disabled"):b.find(C).prop("disabled",!1).removeClass("force-disabled")}else if("redirect"==a&&z){$(e).parents(".ezfc-wrapper").find(".ezfc-message").text(O.form_vars[_].redirect_text).fadeIn(),$(e).fadeOut(),setTimeout(function(){window.location.href=h.redirects[g]},1e3*O.form_vars[_].redirect_timer)}else if("step_goto"!=a&&"step_prev"!=a&&"step_next"!=a||!z)if("set_min"!=a&&"set_max"!=a||!z)if("set_min_selectable"==a&&z)b.attr("data-min_selectable",l),O.checkbox_change(b);else if("set_max_selectable"==a&&z)b.attr("data-max_selectable",l),O.checkbox_change(b);else if("add_class"==a){b[z?"addClass":"removeClass"](l)}else if("remove_class"==a){b[z?"removeClass":"addClass"](l)}else if("set_color"==a&&z)b.find("input, select, .ezfc-price, .ezfc-element-checkbox-text").css("color",l),"submit"==c&&b.css("color",l);else{if("show"==a)n="removeClass",s="addClass";else{if("hide"!=a)continue;n="addClass",s="removeClass"}z?(b[n]("ezfc-hidden ezfc-custom-hidden"),"show"==a?b.addClass("ezfc-fade-in"):b.fadeOut(500,function(){b.removeClass("ezfc-fade-in"),1==O.form_vars[_].clear_selected_values_hidden&&O.clear_hidden_values_element(f)})):1!=o&&(b[s]("ezfc-hidden ezfc-custom-hidden"),"show"==a?b.removeClass("ezfc-fade-in"):b.addClass("ezfc-fade-in"))}else{var D="set_min"==a?"min":"max",N=b.find(":input"),F=parseFloat(l),I=N.data("min"),A=N.data("max");if("set_min"==a&&A<F)continue;if("set_max"==a&&F<I)continue;if(N.data(D,F).trigger("ezfc_blur_trigger"),N.hasClass("ezfc-slider")){var q=b.find(".ezfc-slider-element");void 0!==q.slider&&void 0!==q.slider("instance")&&q.slider("option",D,F)}}else O.set_step_action(_,a)}}}}},this.calculate_element=function(d,_,f){!d&&_&&(d=$("#ezfc_element-"+_).closest(".ezfc-form").data("id"));var u=this.get_element_dom(_),m=this.get_element_object(_);if(void 0!==m){if(u){var p=void 0===m.calculate?[]:m.calculate,h=m.calculate_enabled,v=m.add_to_price,g=m.type,b=(O.form_vars[d].has_steps,m.overwrite_price),z=0,y=O.get_value_from_element(u,null,!1);"subtotal"!=g&&"custom_calculation"!=g&&"extension"!=g||(z=f),"extension"==g&&(p=[]);var e=u.find(".ezfc-element-numbers, .ezfc-element-input-hidden, .ezfc-element-subtotal, .ezfc-element-daterange-container, .ezfc-element-set, .ezfc-element-extension, :selected, :checked, .ezfc-element-custom-calculation, .ezfc-element-table_order"),k=["ceil","floor","round","abs","subtotal"];if($(e).each(function(e,o){if(void 0!==p&&0!=p.length||"custom_calculation"==g)if(O.element_is_visible(_)||0!=m.calculate_when_hidden||"hidden"==g||"custom_calculation"==g)if(h&&0!=h||p.targets||p.values||"set"==g||"subtotal"==g||"hidden"==g||"extension"==g||"custom_calculation"==g)if(h&&0!=h||"custom_calculation"==g){var t=parseFloat(O.get_element_object_value(m,"factor",1));$(o).val();y&&!isNaN(y)||(y=0),t&&!isNaN(t)||0===t||(t=1);var c=y;switch(g){case"numbers":case"extension":case"hidden":c=y;break;case"dropdown":case"radio":case"checkbox":c=parseFloat($(o).data("value")),isNaN(c)&&(c=0);break;case"subtotal":c=f;break;case"daterange":var a=[$(o).find(".ezfc-element-daterange-from").datepicker("getDate"),$(o).find(".ezfc-element-daterange-to").datepicker("getDate")];c=O.jqueryui_date_diff(a[0],a[1],1==O.get_element_object_value(m,"workdays_only",0))*t;break;case"custom_calculation":var i=$(u).find(".ezfc-element-custom-calculation").data("function");try{c=window[i](z)}catch(e){O.add_debug_info("custom_calculation",u,"--- Custom Calculation Error ---\n"+e),c=0}if(h&&(c=parseFloat(c)),$(u).find(".ezfc-element-custom-calculation-input").val(c),2==ezfc_vars.debug_mode){var r=$(u).find(".ezfc-element-custom-calculation script").text();O.add_debug_info("custom_calculation",u,"custom_calculation:\n"+r)}break;case"table_order":var n=0;$.each(ezfc_vars.element_vars[d][_].table_order,function(e,t){var a=O.normalize_value($("#"+t.input_id).val()),i=parseFloat(t.value)*a,r=O.format_price(d,i,null,null,!0);n+=i,$("#"+t.subtotal_id).text(r)}),c=n}if(void 0!==p[0]){for(var s in p)if("__open__"==p[s].target&&void 0===p[s].reference_index)for(var l in p[s].prio=parseInt(p[s].prio),isNaN(p[s].prio)&&(p[s].prio=0),p)s!=l&&(p[l].prio=parseInt(p[l].prio),isNaN(p[l].prio)&&(p[l].prio=0),"__close__"==p[l].target&&p[s].prio==p[l].prio&&void 0===p[s].reference_index&&void 0===p[l].reference_index&&(p[l].operator=p[s].operator,p[l].reference_index=s,p[s].reference_index=l));$.each(p,function(e,t){if(t.operator&&0!=t.operator||"__close__"==t.target){if("__open__"==t.target)return t.value=c,void(c=0);var a=[],i=[];if(-1===$.inArray(t.operator,k)&&"__open__"!=t.target&&"__close__"!=t.target&&(a=O.get_element_dom(t.target),i=O.get_element_object(t.target),!O.element_is_visible(t.target)&&0==i.calculate_when_hidden))return O.add_debug_info("calculate",u,"#"+e+": Skipping this element as it is conditionally hidden."),void(0==e&&"equals"==t.operator&&(c=0));var r,n=t.value,s=0;if("__close__"==t.target){if(void 0===p[t.reference_index])return;r=c,c=p[t.reference_index].value}else 0<a.length?(s=i.id,void 0===t.use_calculated_target_value&&(t.use_calculated_target_value=0),0==t.use_calculated_target_value?r=O.get_value_from_element(a,null,!1):1==t.use_calculated_target_value?r=O.get_target_subtotal_value(d,s)+O.get_calculated_element_value(d,s):2==t.use_calculated_target_value?r=O.get_calculated_element_value(d,s):3==t.use_calculated_target_value?r=O.get_value_from_element(a,null,!1,!0):4==t.use_calculated_target_value&&(r=O.get_value_from_element(a,null,!0,!1,{return_array:!1,return_value:"count"}))):0!=n&&(r=parseFloat(n));switch(r&&!isNaN(r)||(r=0),""!=m.precision&&(r=parseFloat(O.roundTo(r,m.precision))),t.operator){case"add":c+=r;break;case"subtract":c-=r;break;case"multiply":c*=r;break;case"divide":0==r?(O.add_debug_info("calculate",u,"#"+e+": Division by 0."),c=0):(c/=r,"1"==$(o).data("calculate_before")&&(b=1,c=r/y));break;case"equals":c=r;break;case"power":c=Math.pow(c,r);break;case"ceil":c=Math.ceil(c);break;case"floor":c=Math.floor(c);break;case"round":c=Math.round(c);break;case"abs":c=Math.abs(c);break;case"subtotal":c=f;break;case"log":if(0==r)return;c=Math.log(r);break;case"log2":if(0==r)return;c=Math.log2(r);break;case"log10":if(0==r)return;c=Math.log10(r);break;case"sqrt":c=Math.sqrt(c)}O.add_debug_info("calculate",u,"#"+e+": operator = "+t.operator+"\ntarget_value = "+r+"\ntarget_element = #"+s+"\ncalc_value = "+n+"\naddPrice = "+c)}else O.add_debug_info("calculate",u,"#"+e+": No operator found here.")})}1==v?z+=c:2==v&&(z=c),1==b&&(z=c),O.add_debug_info("calculate",u,"===\nprice = "+z+"\naddPrice = "+c+"\nloop_price = "+f+"\nvalue = "+y+"\nfactor = "+t)}else O.add_debug_info("calculate",u,"Calculation is disabled.");else O.add_debug_info("calculate",u,"No target or values were found to calculate with. Subtotal, Hidden and Set elements are skipped.");else O.add_debug_info("calculate",u,"Skipped as element is hidden and calculate_when_hidden is not enabled.")}),void 0!==m.inline_calculation&&"function"==typeof window[m.inline_calculation])try{z=window[m.inline_calculation](z),O.add_debug_info("calculate",u,"===\ninline calculation = "+z)}catch(e){O.add_debug_info("calculate",u,"===\nInvalid inline calculation!")}return 1==this.get_element_object_value(m,"force_use_value_enabled",0)&&(z=this.get_element_object_value(m,"force_use_value",0)),z}console.log("Unable to find element #"+_)}},this.calculate_element_loop=function(e,t,a,i){var r,n=this.get_element_object(e),s=(this.get_element_dom(e),n.form_id),o=n.calculate_enabled,c=n.overwrite_price,l=n.add_to_price,d=0;if(0==o?d=0:1==o&&(d=this.calculate_element(s,e,a),d=this.calculate_discounts(e,d,d),1<=l?1==c?a=d:a+=d:1==c&&(r=d)),("subtotal"==t||"set"==t||"custom_calculation"==t)&&!i){var _=this.get_element_child_input_dom(e);0==o?r=0:1==o&&(r=1==l&&1==c?a:d),_.val(r),_.data("converted",0),this.set_element_object_value(n,"current_value_forced",r)}return a},this.calculate_discounts=function(e,s,t){var o=this.get_element_object(e),c=this.get_element_dom(e),a=this.get_element_child_input_dom(e),l=this.get_element_object_value(o,"overwrite_price",0);if(!o||!e||!this.object_has_property(o,"discount"))return s;var i=o.discount;if(i){var d=i.range_min,_=i.range_max,r=i.operator,f=i.values,u=0,m=this.get_element_object_value(o,"factor",1);if(m&&!isNaN(m)||0===m||(m=1),"input"==o.type||"numbers"==o.type||"subtotal"==o.type||"hidden"==o.type||"extension"==o.type)u=this.normalize_value(a.val(),c,null,0==a.data("converted"));else if("dropdown"==o.type)u=parseFloat(c.find(":selected").data("value"));else if("radio"==o.type)u=parseFloat(c.find(":checked").data("value"));else if("checkbox"==o.type)u=0,c.find(":checked").each(function(e,t){u+=parseFloat($(t).data("value"))});else if("daterange"==o.type){var n=[c.find(".ezfc-element-daterange-from").datepicker("getDate"),c.find(".ezfc-element-daterange-to").datepicker("getDate")];u=O.jqueryui_date_diff(n[0],n[1],1==O.get_element_object_value(o,"workdays_only",0))}"calculated"==this.get_element_object_value(o,"discount_value_type","calculated")&&void 0!==t&&(u=t),$.each(r,function(e,t){var a;if(!(f[e].length<1)&&(d[e]||0===d[e]||(d[e]=Number.NEGATIVE_INFINITY),_[e]||0===_[e]||(_[e]=Number.POSITIVE_INFINITY),u>=parseFloat(d[e])&&u<=parseFloat(_[e]))){var i,r=parseFloat(f[e]);switch(t){case"add":a=s+(i=r),l?s=a:s+=a;break;case"subtract":a=s-(i=r),l?s=a:s-=a;break;case"percent_add":s=a=s+(i=u*m*(r/100));break;case"percent_sub":s=a=s-(i=u*m*(r/100));break;case"equals":s=a=i=r;break;case"factor":a=i=u*r,O.set_element_object_value(o,"factor",r),s=a}if("subtotal"==o.type&&!isNaN(a)){var n=$(c).find("input");n.val(a),n.data("converted",0)}O.add_debug_info("discount",c,"discount = "+i+"\nprice after discount = "+s)}})}return s},this.calculate_set_elements=function(e,t,a,i,r){var n,s=a.data("set_operator"),o=a.data("set_elements"),c=1==a.data("set_allow_zero"),l=a.data("set_dom_selector"),d=O.get_element_object(a.data("id")),_=[];if(o||l){if(l)_=$(l);else{var f=o.toString().split(",");$.each(f,function(e,t){var a=$("#ezfc_element-"+t);a&&_.push(a)})}$.each(_,function(e,t){var a=$(t),i=O.get_value_from_element(a,null,!1);if(c||0!=i)if(0!=e)switch(s){case"min":i<n&&(n=i);break;case"max":n<i&&(n=i);break;case"avg":case"sum":n+=i;break;case"dif":n-=i;break;case"prod":n*=i;break;case"quot":0!=i&&(n/=i)}else n=i}),"avg"==s&&(n/=_.length);var u=this.normalize_value(n,a);d.current_value=n,d.current_value_formatted=u,a.find("input").val(u)}},this.calculate_price=function(e){var t=$(e).data("id"),a=0;this.subtotals[t]=[];var i=0<this.trigger_list[t].length?this.trigger_list[t]:O.form_vars[t].form_elements_order,r=!0;for(var n in i){var s=i[n],o=O.get_element_object(s),c=O.get_element_dom(s);void 0===o.calculate&&"custom_calculation"!=o.type&&"matrix"!=o.type&&"set"!=o.type||(r=!1,O.calculate_get_external_values(e,t,c,o.type),O.calculate_conditionals(e,t,s,o.type),(O.element_is_visible(s)||0!=o.calculate_when_hidden||"hidden"==o.type||"custom_calculation"==o.type)&&O.calculate_set_elements(e,t,c,o.type))}if(r)return this.price_old_global[t];for(var l in O.form_vars[t].form_elements_order){s=O.form_vars[t].form_elements_order[l],o=O.get_element_object(s),c=O.get_element_dom(s);if(void 0!==o.calculate||"custom_calculation"===o.type||"matrix"==o.type||"set"==o.type){var d=O.calculate_element_loop(s,o.type,a);if(O.calculate_conditionals(e,t,s,o.type),O.set_element_object_value(s,"current_value",d),1==O.get_element_object_value(o,"calculate_enabled",1)&&0<O.get_element_object_value(o,"add_to_price",1)&&this.element_can_calculate_visibility(s)&&(a=d),0==O.get_element_object_value(o,"add_to_price",1)){var _=O.get_value_from_element(c,null,!0);O.set_element_object_value(o,"current_value",_)}1==O.get_element_object_value(o,"calculate_enabled",1)&&O.subtotals[t].push({el_id:s,price:a})}}return a},this.set_price=function(e,t,a){var r=$(e).data("id");a?price=a:t&&0===t||(price=this.calculate_price($(e))),this.set_subtotal_values($(e)),1!=this.form_vars[r].price_show_request||0!=this.form_vars[r].price_requested?((void 0===this.price_old_global[r]||isNaN(this.price_old_global[r]))&&(this.price_old_global[r]=0),$form_price_elements=$(document).find(".ezfc-price-value[data-id='"+r+"']"),this.price_old_global[r]!=price?(0!=this.form_vars[r].counter_duration?$form_price_elements.countTo({from:O.price_old_global[r],to:price,speed:this.form_vars[r].counter_duration,refreshInterval:this.form_vars[r].counter_interval,formatter:function(e,t){var a=O.format_price(r,e),i=numeral(a).value();return!isNaN(i)&&i||(a=0),a}}):$form_price_elements.text(this.format_price(r,price)),this.price_old_global[r]=price):$form_price_elements.text(this.format_price(r,price))):this.price_request_toggle(r,!1)},this.format_value_element=function(e,t){var a=this.get_element_object(e);return this.format_price(a.form_id,t,null,a.price_format,a.is_currency,!0)},this.format_price=function(e,t,a,i,r,n){var s=this.defaultFormat,o=a||this.form_vars[e].currency;this.form_vars[e].price_format&&0<this.form_vars[e].price_format.length&&(s=this.form_vars[e].price_format),void 0!==i&&(s=i),isNaN(t)&&(t=0);var c=(n?numeral().set(t):numeral(t)).format(s);return isNaN(numeral(c).value())&&(c=numeral(0).format(s)),1==ezfc_vars.price_format_replace_trailing_zeros.enabled&&parseFloat(t).toFixed(6)%1==0&&(c+=ezfc_vars.price_format_dec_point+ezfc_vars.price_format_replace_trailing_zeros.text),1==r&&1==O.form_vars[e].format_currency_numbers_elements&&(0==this.form_vars[e].currency_position?c=o+c:c+=o),c},this.price_request_toggle=function(e,t,a){var i=$(".ezfc-form[data-id='"+e+"']");t?(this.price_old_global[e]=0,this.form_vars[e].price_requested=1,this.calculate_price(i),this.set_price(i,null,a),this.set_submit_text(i)):(this.form_vars[e].price_requested=0,$(i).find(".ezfc-price-value").text(this.form_vars[e].price_show_request_before),$(i).find(".ezfc-submit").val(this.form_vars[e].submit_text.request))},this.set_subtotal_values=function(e){var f=["subtotal","set","numbers","custom_calculation"],t=$(e).data("id"),u=["subtotal","set"];$.each(O.form_vars[t].form_elements_order,function(e,t){var a=O.get_element_object(t),i=O.get_element_dom(t);if(-1!==$.inArray(a.type,f)){var r=O.get_element_object_value(a,"precision",2),n=a.price_format;"custom_calculation"==a.type?$element_input=i.find(".ezfc-element-custom-calculation-input"):$element_input=i.find(".ezfc-element-"+a.type);var s=a.current_value;O.object_has_property(a,"current_value_forced")&&(s=a.current_value_forced);var o=O.normalize_value(s,$element_input,r,0==$element_input.data("converted"));if(""!=$element_input.data("min")){var c=parseFloat($element_input.data("min"));o<c&&(o=c)}if(""!=$element_input.data("max")){var l=parseFloat($element_input.data("max"));l<o&&(o=l)}var d=O.format_price(a.form_id,o,null,n,!1,0==$element_input.data("converted")),_=O.format_price(a.form_id,o,null,n,a.is_currency,0==$element_input.data("converted"));_=O.get_element_object_value(a,"text_before","")+_+O.get_element_object_value(a,"text_after",""),-1!==$.inArray(a.type,u)&&($element_input.val(_),$element_input.data("converted",1)),i.find(".ezfc-text").text(d)}})},this.scroll=function(){$(".ezfc-fixed").each(function(){var e=$(this).data("id");if(O.form_vars[e]){var t="ezfc-fixed-scrolling",a=$(this).offset(),i=$(".ezfc-form[data-id='"+e+"']"),r=i.outerHeight(),n=i.offset(),s=$(window).scrollTop(),o=parseFloat(O.form_vars[e].price_position_scroll_top),c=n.top-s-o;c<0&&-r<c?($(this).offset({top:s+o}),$(this).addClass(t)):0<c&&a.top>n.top&&($(this).offset({top:n.top}),$(this).removeClass(t))}})},this.reset_disabled_fields=function(e,t){var a=$(e).closest(".ezfc-wrapper");$(e).find(".ezfc-custom-hidden").each(function(){$.each($(this).find("input, :selected"),function(e,t){$(this).val($(this).data("index")).removeAttr("disabled"),$(this).is(":checked")&&$(this).prop("checked",!1)})}),a.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!1),this.set_submit_text(e,t)},this.reset_form=function(e){this.init_form(e),this.reset_elements(e),this.set_step(e,0,0),this.form_change(e)},this.reset_elements=function(e){e.find(".ezfc-custom-element").each(function(){var e=$(this).data("element"),t=$(this).find("[data-initvalue]").data("initvalue");switch(e){case"checkbox":$(this).find("input").each(function(){1==(t=$(this).data("initvalue"))?$(this).prop("checked",!0):$(this).removeAttr("checked")});break;case"dropdown":$(this).find("option").removeAttr("selected"),$(this).find("option[data-index='"+t+"']").prop("selected",!0);break;case"numbers":$(this).find("input").val(t);var a=$(this).find(".ezfc-slider-element");a.length&&a.slider({value:t});break;case"radio":$(this).find("input").removeAttr("checked"),$(this).find("input[data-initvalue]").prop("checked",!0);break;case"textfield":$(this).find("textarea").val(t);break;default:$(this).find("input").val(t)}}),e.find(".ezfc-selected").removeClass("ezfc-selected")},this.set_step=function(t,a,e){var i=parseInt(t.find(".ezfc-step-active").data("step")),r=t.find(".ezfc-step[data-step='"+i+"']"),n=t.data("id");if(i!=a){if(1==e&&1==this.form_vars[n].verify_steps)return t.find(".ezfc-step-submit-icon").fadeIn(),this.form_submit(t,a-1),void $(".ezfc-has-hidden-placeholder").val("").removeClass("ezfc-has-hidden-placeholder");var s=parseInt(this.form_vars[n].step_indicator_start)-1,o=parseInt(this.form_vars[n].step_speed);if(isNaN(o)&&(o=200),r.fadeOut(o,function(){var e=t.find(".ezfc-step[data-step='"+a+"']");e.fadeIn(o).addClass("ezfc-step-active"),$(this).removeClass("ezfc-step-active"),s<=a?t.find(".ezfc-step-indicator").fadeIn():t.find(".ezfc-step-indicator").hide(),O.scroll_to(e)}),t.find(".ezfc-step-indicator-item").each(function(){var e=parseInt($(this).data("step"));$(this).removeClass("ezfc-step-indicator-item-active"),e<=a&&$(this).addClass("ezfc-step-indicator-item-active")}),a<i&&1==O.form_vars[n].step_reset_succeeding)for(var c=a+1;c<O.form_vars[n].step_count;c++){var l=$(".ezfc-step[data-step='"+c+"']");this.reset_elements(l)}return O.current_steps[n]=a,O.calculate_price(t),!1}},this.set_step_action=function(e,t){var a=$("#ezfc-form-"+e),i=parseInt(a.find(".ezfc-step-active").data("step")),r=0;switch(t){case"step_prev":if(0==i)return;r=i-1;break;case"step_next":if(i==a.find(".ezfc-step-start").length-1)return;r=i+1;break;case"step_goto":var n=a.find(".ezfc-step-start[data-id='"+cond.target[ic]+"']");if(n.length<1)return;r=parseInt(n.data("step"))}setTimeout(function(){O.set_step(a,r,1)},350)},this.scroll_to=function(e,t){var a=$(e).offset();if(void 0!==a&&0!=ezfc_vars.auto_scroll_steps){var i=parseFloat(t)||parseFloat(ezfc_vars.scroll_steps_offset)||50,r=a.top+i;$("html, body").animate({scrollTop:r})}},this.get_element_dom=function(e){return void 0!==this.$form_elements[e]&&this.$form_elements[e].$element},this.get_element_child_input_dom=function(e){return void 0!==this.$form_elements[e]&&this.$form_elements[e].$element_input},this.get_element_object=function(e){if(void 0===this.$form_elements[e])return!1;var t=this.$form_elements[e].form_id;return void 0!==ezfc_vars.element_vars[t][e]&&ezfc_vars.element_vars[t][e]},this.get_element_object_value=function(e,t,a){return"object"!=typeof e&&(e=this.get_element_object(e)),e&&this.object_has_property(e,t)?e[t]:a},this.set_element_object_value=function(e,t,a){if("object"!=typeof e){if("price"==e||"submit_button"==e)return;e=this.get_element_object(e)}if(!e)return!1;e[t]=a},this.set_element_list_object_value=function(e,t,a){for(var i in e)O.set_element_object_value(e[i],t,a)},this.get_top_parent_group_id=function(e){var t=this.get_element_object(e);return!!t&&(0!=t.group_id?this.get_top_parent_group(t.group_id):t.id)},this.has_parent_group_id=function(e,t){var a=this.get_element_object(e);return!(!a.group_id||0==a.group_id)&&(e!=t&&(a.group_id==t||this.has_parent_group_id(a.group_id,t)))},this.get_group_children=function(e){var t=this.get_element_object(e);if(!t)return[];var a=[];for(var i in O.form_vars[t.form_id].form_elements_order){var r=O.form_vars[t.form_id].form_elements_order[i];O.get_element_object(r);r!=e&&(O.has_parent_group_id(r,e)&&a.push(r))}return a},this.get_value_from_element=function(e,t,a,i,r){if(r=$.extend({},{return_array:!1,return_value:"value"},r),e||(e=this.$form_elements[t].$element),!e.length)return this.debug_message("Unable to find element #"+t),0;t||(t=e.data("id"));var n=this.get_element_object(t);if(!n)return 0;var s=this.get_element_child_input_dom(t),o=n.type,c=1,l=s.val(),d=0==s.data("converted"),_=this.normalize_value(l,e,null,d);if(0==n.calculate_when_hidden&&!this.element_is_visible(t)&&"hidden"!=o&&"custom_calculation"!=o)return 0;_&&!isNaN(_)||(_=0);var f=a?_:parseFloat(_);switch("count"==r.return_value&&(f=0),o){case"subtotal":case"numbers":case"hidden":case"extension":(c=this.get_element_object_value(t,"factor",1))&&!isNaN(c)||0===c||(c=1),f=a?l:i?_:_*c;break;case"dropdown":case"radio":case"checkbox":var u=r.return_value,m=!a&&-1===$.inArray(u,["count","name","option_id"]);e.find(":selected, :checked").each(function(){if(m)f+=parseFloat($(this).data("value"));else if("object"!=typeof f&&"count"!=u&&(f=[]),"name"==u){var e=$(this).data("index");f.push(n.options[e].text)}else"option_id"==u?f.push($(this).data("optionid")):"count"==u?f++:f.push($(this).data(u))});break;case"daterange":var p=[e.find(".ezfc-element-daterange-from").datepicker("getDate"),e.find(".ezfc-element-daterange-to").datepicker("getDate")];if((c=parseFloat(e.find(".ezfc-element-daterange-from").data("factor")))&&!isNaN(c)||0===c||(c=1),a)f=p;else{e.find(".ezfc-element-daterange-container");var h=O.jqueryui_date_diff(p[0],p[1],1==this.get_element_object_value(n,"workdays_only",0));f=i?h:h*c}break;case"custom_calculation":f=e.find(".ezfc-element-custom-calculation-input").val(),a||(f=parseFloat(f));break;case"starrating":f=parseFloat(e.find(":checked").val()),isNaN(f)&&(f=0);break;case"table_order":var v=0;$.each(n.table_order,function(e,t){var a=parseFloat($("#"+t.input_id).val()),i=parseFloat(t.value)*a;O.format_price(n.form_id,i,null,null,!0);"count"==r.return_value?v+=a:v+=i}),f=v;break;case"set":f=n.current_value;break;case"fileupload":case"group":case"heading":case"hr":case"html":case"image":case"placeholder":case"spacer":case"stepstart":case"stepend":f=0;break;default:f=l}return a?f:(isNaN(f)&&(f=0),f?parseFloat(f):0)},this.checkbox_change=function(e){var t=parseInt(e.attr("data-max_selectable"));(t||e.find("input:not(:checked):not(.force-disabled)").removeAttr("disabled"),t&&0<=t)&&(t<=e.find(":checked").length?e.find("input:not(:checked)").attr("disabled","disabled"):e.find("input:not(:checked):not(.force-disabled)").removeAttr("disabled"))},this.checkbox_change_state=function(e,t,a,i){if(e.attr("disabled"))return!1;null==t&&(t=!e.is(":checked"));var r=e.closest(".ezfc-element-single-option-container");if(r.hasClass("ezfc-element-option-has-image")){var n=e.siblings(".ezfc-element-option-image");t?n.addClass("ezfc-selected"):n.removeClass("ezfc-selected")}t?r.addClass("ezfc-option-wrapper-selected"):r.removeClass("ezfc-option-wrapper-selected"),i||e.prop("checked",t),a||e.trigger("change")},this.radio_change_state=function(e,t,a){var i=e.closest(".ezfc-form").data("id");if(e.attr("disabled"))return!1;void 0===t&&(t=!e.is(":checked"));var r=e.closest(".ezfc-element-radio-container"),n=r.closest(".ezfc-element-wrapper-radio");if(r.find(".ezfc-selected").removeClass("ezfc-selected"),r.find(".ezfc-element-radio-input").removeAttr("checked"),t&&(r.siblings(".ezfc-option-wrapper-selected").removeClass("ezfc-option-wrapper-selected"),r.addClass("ezfc-option-wrapper-selected")),r.hasClass("ezfc-element-option-has-image")){var s=e.siblings(".ezfc-element-option-image");t&&(e.attr("checked","checked"),e.prop("checked",!0),n.find(".ezfc-selected").removeClass("ezfc-selected"),s.addClass("ezfc-selected"))}else t&&(e.attr("checked","checked"),e.prop("checked",!0));a||e.trigger("change"),1==this.form_vars[i].step_auto_progress&&!n.hasClass("disable-auto-progress")&&t&&this.set_step_action(i,"step_next")},this.live_summary_update=function(e){if(0!=this.form_vars[e].live_summary_enabled){var i="";$.each(ezfc_vars.element_vars[e],function(e,t){if(void 0!==t.current_value&&0!=t.show_in_live_summary){var a=$.trim(t.current_value);if(void 0!==t.options){if(0==(a=O.get_value_from_element(null,t.id,!0,null,{return_value:"name"})))return}else void 0!==t.current_value_formatted&&(a=t.current_value_formatted);""!=a&&0!=a&&("object"==typeof a&&(a="<ul class='ezfc-live-summary-list'><li class='ezfc-live-summary-list-item'>"+a.join("</li><li class='ezfc-live-summary-list-item'>")+"</li></ul>"),i+="<div class='ezfc-live-summary-item'><div class='ezfc-live-summary-item-name'>"+t.label+"<span class='ezfc-live-summary-item-separator'></span></div><div class='ezfc-live-summary-item-value'>"+a+"</div></div>")}}),$("#ezfc-live-summary-"+e).html(i)}},this.input_format_listener_change=function(c){var e=c.parent().closest(".ezfc-element").data("id"),l=this.get_element_object(e),d=l.form_id,_=this.get_element_object_value(l,"text_before",""),f=this.get_element_object_value(l,"text_after",""),u=this.get_element_object_value(l,"price_format",null);c.on("focus click",function(){var e=O.escape_regex(_),t=O.escape_regex(f);""!=_&&(this.value=this.value.replace(new RegExp("^"+e,""),"")),""!=f&&(this.value=this.value.replace(new RegExp(t+"$",""),"")),1==l.is_number&&(this.value=this.value.replace(/[^0-9\.,-]/g,""),this.value=this.value.replace(ezfc_vars.price_format_dec_thousand,""))});var t=function(e,t){var a=e.value;if(1==O.get_element_object_value(l,"is_number",1)){e.value=e.value.replace(/[^0-9\.,-]/g,"");var i=c.data("min"),r=c.data("max");if(""!=e.value){var n=O.normalize_value(e.value);isNaN(n)||(""!=i&&!isNaN(i)&&n<i&&(e.value=i),""!=r&&!isNaN(r)&&r<n&&(e.value=r))}}var s=e.value!=a;if(1==O.get_element_object_value(l,"is_currency",1)){var o=O.normalize_value(e.value);e.value=O.format_price(d,o,null,u,O.form_vars[d].format_currency_numbers_elements)}""!=e.value&&(e.value=_+e.value+f),O.set_element_object_value(l,"current_value_formatted",e.value),s&&!t&&O.form_change(null,d),O.live_summary_update(d)};c.on("blur",function(){t(this)}),c.bind("ezfc_blur_trigger",function(){t(this,!0)})},this.element_is_visible=function(e){var t=this.get_element_object(e);if(!t)return!1;var a=this.$form_elements[e].$element,i=this.$form_elements[e].form_id;this.form_vars[i].has_steps;return!a.hasClass("ezfc-custom-hidden")&&!a.hasClass("ezfc-hidden")&&(0==t.group_id||a.closest(".ezfc-custom-hidden, .ezfc-hidden").length<1)},this.element_can_calculate_visibility=function(e){var t=this.get_element_object(e);return!!t&&(0!=this.get_element_object_value(t,"calculate_when_hidden",0)||this.element_is_visible(e))},this.clear_hidden_values=function(e){var t=$(e).data("id");1==this.form_vars[t].clear_selected_values_hidden&&$(e).find(".ezfc-custom-hidden").each(function(){$(this).find("input[type='text']").val(""),$(this).find(":checkbox, :radio").prop("checked",!1)})},this.clear_hidden_values_element=function(e){var t=this.get_element_object(e),a=this.get_element_dom(e),i=this.get_element_child_input_dom(e);"input"==t.type||"numbers"==t.type||"subtotal"==t.type?i.val(""):"dropdown"==t.type?a.find(":selected").removeAttr("selected"):"radio"!=t.type&&"checkbox"!=t.type||a.find(":checked").removeAttr("checked")},this.escape_regex=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},this.normalize_value=function(e,t,a,i){if(e=String(e),void 0!==t){var r=$(t).data("id"),n=this.get_element_object(r),s=$.trim(this.get_element_object_value(n,"text_before","")),o=$.trim(this.get_element_object_value(n,"text_after",""));if(""!=s){var c=O.escape_regex(s);e=e.replace(new RegExp("^"+c,""),"")}if(""!=o){var l=O.escape_regex(o);e=e.replace(new RegExp(l+"$",""),"")}}var d=parseFloat(e);return void 0===a||!a&&0!=a||(d=d.toFixed(a)),i||(d=numeral(e).value()),d},this.set_submit_text=function(e,t){var a=$(e).data("id"),i=$(e).find(".ezfc-submit"),r="default",n=this.form_vars[a].submit_text.default;if(1==this.form_vars[a].price_show_request){if(this.form_vars[a].price_requested&&!t||(n=this.form_vars[a].submit_text.request,r="request"),t)return this.price_request_toggle(a,!1),!1}else if(1==this.form_vars[a].summary_enabled&&0==this.form_vars[a].summary_shown)r="summary",n=this.form_vars[a].submit_text.summary;else if(1==this.form_vars[a].use_paypal)r="paypal",n=this.form_vars[a].submit_text.paypal;else if(1==this.form_vars[a].payment_force_stripe)r="stripe",n=this.form_vars[a].submit_text.stripe;else if(1==this.form_vars[a].use_woocommerce)r="woocommerce",n=this.form_vars[a].submit_text.woocommerce;else{n=this.form_vars[a].submit_text.default;var s=$(e).find(".ezfc-element-wrapper-payment");if(0<s.length){var o=$(s).find(":checked").data("value");void 0!==this.form_vars[a].submit_text[o]&&(r=o,n=this.form_vars[a].submit_text[o])}}i.val(n),i.data("type",r)},this.prevent_enter_step_listener=function(e,t){$(e).keypress(function(e){e.keyCode||e.which;13==e.which&&e.preventDefault()})},this.call_hook=function(e,t){var a=window[e];"function"==typeof a&&a(t=t||{})},this.stripe_response_handler=function(e,t){var a=$(".ezfc-form[data-id='"+O.payment_form_id+"']"),i=$(".ezfc-payment-form[data-form_id='"+O.payment_form_id+"']");if(t.error)O.debug_message(t.error.message),$("#ezfc-payment-message-"+O.payment_form_id).text(t.error.message),i.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!1),setTimeout(function(){$("#ezfc-payment-message-"+O.payment_form_id).text("")},7500);else{var r=t.id;a.find("#ezfc-stripetoken-"+O.payment_form_id).val(r),O.form_submit(a,-1,"stripe-checkout")}},this.authorize_create_token=function(e){var t={};authData={},cardData={};$("#ezfc-authorize-form-"+e);cardData.cardNumber=$("#ezfc-element-payment-authorize-card-number-"+e).val(),cardData.cardNumber=cardData.cardNumber.replace(/ /g,""),cardData.month=$("#ezfc-element-payment-authorize-expiry-month-"+e).val(),cardData.year=$("#ezfc-element-payment-authorize-expiry-year-"+e).val(),cardData.cardCode=$("#ezfc-element-payment-authorize-cvc-"+e).val(),t.cardData=cardData,authData.clientKey=ezfc_vars.authorize.client_key,authData.apiLoginID=ezfc_vars.authorize.api_login_id,t.authData=authData,Accept.dispatchData(t,O.authorize_response_handler)},this.authorize_response_handler=function(e){var t=$(".ezfc-form[data-id='"+O.payment_form_id+"']"),a=$(".ezfc-payment-form[data-form_id='"+O.payment_form_id+"']"),i=t.data("id");if("Error"===e.messages.resultCode){a.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!1);for(var r=[],n=0;n<e.messages.message.length;n++)r.push(e.messages.message[n].text),O.debug_message(e.messages.message[n].code+": "+e.messages.message[n].text);O.set_message(i,r.join(" "))}else{var s=e.opaqueData.dataValue;$("#ezfc-authorizetoken-"+O.payment_form_id).val(s),O.form_submit(t,-1,"authorize-checkout")}},this.check_datepicker_days=function(e,t,a){if(!e||"object"!=typeof e||"function"!=typeof e.setHours)return[!1,""];e.setHours(0,0,0,0);var i=e.getTime();if(a.length)for(var r in a){if(-1!==a[r].indexOf(":")){var n=a[r].split(":");if(2==n.length){var s=new Date(n[0]),o=new Date(n[1]);if(i>=s.getTime()&&i<=o.getTime())return[!1,""]}}else{if(i==new Date(a[r]).getTime())return[!1,""]}}var c=e.getDay();return[-1!==$.inArray(c,t),""]},this.check_datepicker_predefined_values=function(e){var t=e.val(),a=!1;if(""!=t){switch(t){case"__today__":a=new Date;break;case"__tomorrow__":a=new Date((new Date).getTime()+864e5);break;default:a=t}a&&e.datepicker("setDate",a)}},this.check_inline_math=function(e,t){var a=["=","+","-","*","/","s"],i=(e=$.trim(e)).split(/([\=\+\-\*\/s][+-]?([0-9]*[.])?[0-9]+)/g);if(i.length){var r=O.get_value_from_element(t,null,!1,!0,{return_value:"base"});for(var n in i)if(i[n]){var s=i[n].toString().charAt(0);if(-1!==$.inArray(s,a)){var o=i[n].substring(1);isNaN(o)||(o=parseFloat(o),"="==s?r=o:"+"==s?r+=o:"-"==s?r-=o:"*"==s?r*=o:"/"==s?r/=o:"s"==s&&(r*=-1),e=r)}}}return e},this.get_target_subtotal_value=function(e,t,a){for(var i in this.subtotals[e])if(this.subtotals[e][i].el_id==t)return a?void 0!==this.subtotals[e][i-1]?this.subtotals[e][i-1].price:0:this.subtotals[e][i].price;return null},this.get_calculated_element_value=function(e,t){$("#ezfc-form-"+e);var a=this.get_element_object(t),i=this.$form_elements[t].$element.data("element");return 0==this.get_element_object_value(a,"calculate_enabled",1)?0:this.calculate_element_loop(t,i,0,!0)},this.set_message=function(e,t){var a=$("#ezfc-form-"+e);if(!a)return!1;var i,r=a.closest(".ezfc-wrapper");if(!(i=0<r.find(".ezfc-payment-dialog-open").length?r.find(".ezfc-payment-errors"):$("#ezfc-message-"+e)).length&&console)return console.log(t),!1;i.text(t).fadeIn().delay(7500).fadeOut()},this.recaptcha_reload=function(){$(".ezfc-form .g-recaptcha").length&&"undefined"!=typeof grecaptcha&&grecaptcha.reset()},this.populate_html_placeholders=function(s){s.find(".ezfc-html-placeholder").each(function(e,t){var a=$(t),i="",r=O.functions.get_element_id_by_name(s.data("id"),a.data("listen_target"));if(r){var n=a.data("listen_retrieve");"object"==typeof(i=O.get_value_from_element(!1,r,!0,!1,{return_value:n}))&&(i=i.join(", ")),i=$.trim(i),a.text(i)}})},this.group_repeat=function(a){void 0===this.group_repeat_elements[a]&&(this.group_repeat_elements[a]=0),this.group_repeat_elements[a]++;var e=$("#ezfc_element-"+a),t=e.clone(!0),i=e.closest(".ezfc-form");t.find(".ezfc-group-repeatable-wrapper").remove(),t.insertAfter(e).attr("id",t.attr("id")+this.group_repeat_elements[a]),t.find("[id^='ezfc_element-']").each(function(){var e=$(this).attr("id")+"-"+O.group_repeat_elements[a],t=$(this).data("id")+"-"+O.group_repeat_elements[a];$(this).attr("id",e),$(this).data("id",t)}),this.form_change(i)},this.toggle_group=function(e,t){var a=e.find("> .ezfc-group-elements").first();if(e.hasClass("ezfc-group-collapsible")){a.slideToggle(500);var i="ezfc-group-active",r="fa-chevron-circle-down",n="fa-chevron-circle-right",s=e.find(".ezfc-collapse-icon i").first();s.hasClass(r)&&!t?(s.removeClass(r).addClass(n),e.removeClass(i)):(s.removeClass(n).addClass(r),e.addClass(i))}},this.init_tips=function(){$(".ezfc-element-description[data-ezfctip]").each(function(){var e=$(this).data("ezfctip");new Opentip($(this),{background:ezfc_vars.opentip.background||"yellow",removeElementsOnHide:!0,target:$(this),tipJoint:ezfc_vars.required_text_position||"middle right"}).setContent(e)})},this.show_tip=function(e,t,a,i){var r=new Opentip(e,{background:ezfc_vars.opentip.background||"yellow",delay:a,hideDelay:.1,hideTriggers:["closeButton","target"],removeElementsOnHide:!0,showOn:null,target:t,tipJoint:ezfc_vars.required_text_position||"middle right"});r.setContent(i),r.show()},this.submit_cancel=function(e,t){var a=e.closest(".ezfc-wrapper"),i=e.find("input[type='submit']"),r=e.find(".ezfc-submit-icon"),n=e.data("id");for(var s in r.fadeOut(),i.prop("disabled",!1),a.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!1),this.payment_methods){var o=O.payment_methods[s];O.form_vars[n].payment_info_shown[o]=0}},this.popup_form_open=function(e){$(".ezfc-modal").addClass("ezfc-modal-open"),$("#ezfc-form-popup-"+e).fadeIn()},this.popup_form_close=function(e){$(".ezfc-modal").removeClass("ezfc-modal-open"),$("#ezfc-form-popup-"+e).fadeOut()},this.remove_debug_info=function(){$(".ezfc-debug-info").remove()},this.add_debug_info=function(e,t,a){if(2==ezfc_vars.debug_mode&&"group"!=(e=e||$(t).data("element"))){var i=$(t).attr("id");i&&(i=i.split("ezfc_element-")[1]);var r="ezfc-debug-"+i,n=$("#"+r).length;if("custom_calculation"!=e||!n){var s="[["+e+" #"+i+"]]\n["+e+"]\n"+a+"\n\n";n?$(t).find(".ezfc-debug-info").append(s):$(t).append("<pre id='"+r+"' class='ezfc-debug-info ezfc-debug-type-"+e+"'>"+s+"</pre>"),console.log(a,t)}}},this.debug_message=function(e){0!=ezfc_vars.debug_mode&&console.log(e)},this.jqueryui_date_diff=function(e,t,a){if(!e||!t)return 0;var i=0;if(a)for(;e<t;)0!==e.getDay()&&6!==e.getDay()&&i++,e.setDate(e.getDate()+1);else i=(t-e)/1e3/60/60/24,i=Math.ceil(i);return i},this.roundTo=function(e,t){var a=Math.pow(10,t),i=e*a;return Math.round(i)/a},this.sprintf=function(){var a=arguments,e=a[0],i=1;return e.replace(/%((%)|s|d)/g,function(e){var t=null;if(e[2])t=e[2];else{switch(t=a[i],e){case"%d":t=parseFloat(t),isNaN(t)&&(t=0)}i++}return t})},this.throttle=function(i,r,n){var s,o;return r=r||(r=100),function(){var e=n||this,t=+new Date,a=arguments;s&&t<s+r?(clearTimeout(o),o=setTimeout(function(){s=t,i.apply(e,a)},r)):(s=t,i.apply(e,a))}},this.unique=function(e){var a=[];return $.each(e,function(e,t){-1===$.inArray(t,a)&&a.push(t)}),a},this.has_class=function(e,t){for(var a in t)if(e.hasClass(t[a]))return!0;return!1},this.object_has_property=function(e,t){return"object"==typeof e&&null!==e&&e.hasOwnProperty(t)},this.init()},ezfc_functions={},jQuery(document).ready(function(e){EZFC=new EZFC_Object(e)});