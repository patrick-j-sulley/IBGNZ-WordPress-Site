EZFC_Object=function(e){var t=this;this.init=function(){"undefined"==typeof EZFC_LOADED&&(EZFC_LOADED=!0,this.form_vars=[],this.$form_elements=[],this.subtotals=[],this.conditional_once=[],this.payment_form_id=0,this.payment_methods=["stripe","authorize"],this.elements_cache=[],this.group_repeat_elements=[],this.uploaded_files=[],this.functions={calculate_element:function(e,a){return t.calculate_element(e,a)},calculate_price:function(a){var i=e(".ezfc-form[data-id='"+a+"']");return t.calculate_price(i)},get_element_id_by_name:function(a,i){return"undefined"==typeof t.elements_cache[a][i]&&(t.elements_cache[a][i]=e("#ezfc-form-"+a+" .ezfc-element[data-elementname='"+i+"']")),t.elements_cache[a][i].length?t.elements_cache[a][i].data("id"):!1},get_value_from:function(e,a){return t.get_value_from_element(null,e,a)},get_value_from_name:function(e,t,a){var i=this.get_element_id_by_name(e,t);return this.get_value_from(i,a)},get_calculated_value_from:function(e,a){return t.get_calculated_element_value(e,a)},price_format:function(e,a,i,r,n){return t.format_price(e,a,i,r,n)}},ezfc_functions=this.functions,this.external_listeners=[],this.price_old_global=[],numeral.language("ezfc",{delimiters:{decimal:ezfc_vars.price_format_dec_point,thousands:ezfc_vars.price_format_dec_thousand},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),numeral.language("ezfc"),this.defaultFormat=ezfc_vars.price_format?ezfc_vars.price_format:"0,0[.]00",numeral.defaultFormat(this.defaultFormat),e.datepicker.setDefaults(e.datepicker.regional[ezfc_vars.datepicker_language]),this.attach_events())},this.attach_events=function(){e(".ezfc-element-option-image").click(function(){e(this).hasClass("ezfc-element-radio-image")?t.radio_change_state(e(this).siblings(".ezfc-element-radio-input")):e(this).hasClass("ezfc-element-checkbox-image")&&t.checkbox_change_state(e(this).siblings(".ezfc-element-checkbox-input"))}),e(".ezfc-addon-option").click(function(){e(this).siblings(".ezfc-element-option-image").click()}),e(".ezfc-form").each(function(){var a=e(this),i=a.closest(".ezfc-wrapper");t.init_form(a),t.init_form_ui(a),i.find(".ezfc-form-loading-text").length&&i.find(".ezfc-form-loading-text").fadeOut(500,function(){a.fadeIn(500,function(){i.removeClass("ezfc-form-loading"),t.form_change(a),t.scroll()})}),e(document).trigger("ezfc_forms_loaded")}),e(".ezfc-element-fileupload").each(function(a,i){var r=e(this).closest(".ezfc-element"),n=r.find(".ezfc-upload-button"),s=r.find(".ezfc-fileupload-files"),o=r.data("id"),c=(e(this).attr("multiple")?!0:!1,e(this).closest(".ezfc-form")),l=c.find("input[name='id']").val(),d=c.find("input[name='ref_id']").val(),f={action:"ezfc_frontend_fileupload",data:"action=upload_file&id="+l+"&ref_id="+d};return"function"!=typeof e.prototype.fileupload?(t.debug_message("Unable to load fileupload function."),!1):void e(this).fileupload({formData:f,dataType:"json",add:function(t,a){r.find(".ezfc-bar").css("width",0),r.find(".progress").addClass("active"),r.find(".ezfc-fileupload-message").text(""),n.off("click"),n.click(function(){return""==e(i).val()?!1:(a.files=a.originalFiles,a.submit(),e(n).attr("disabled","disabled"),t.preventDefault(),!1)})},done:function(a,i){if(n.removeAttr("disabled"),i.result.error)return r.find(".ezfc-fileupload-message").text(i.result.error),r.find(".ezfc-bar").css("width",0),!1;"undefined"==typeof t.uploaded_files[l]&&(t.uploaded_files[l]=[]),"undefined"==typeof t.uploaded_files[l][o]&&(t.uploaded_files[l][o]=[]);for(var c in i.result)t.uploaded_files[l][o].push({id:i.result[c].success,name:i.files[c].name});e(this).val(""),e(this).attr("multiple")||e(this).attr("disabled","disabled"),r.find(".progress").removeClass("active"),r.find(".ezfc-fileupload-message").text(ezfc_vars.upload_success);var f="";for(var c in t.uploaded_files[l][o])f+="<li class='ezfc-fileupload-files-item' data-fileid='"+t.uploaded_files[l][o][c].id+"' data-refid='"+d+"'>"+t.uploaded_files[l][o][c].name+" <span class='ezfc-fileupload-files-remove'><i class='fa fa-close'></i></span></li>";s.html(f)},progressall:function(t,a){var i=parseInt(a.loaded/a.total*100,10);e(r).find(".ezfc-bar").css("width",i+"%")},replaceFileInput:!1,url:ezfc_vars.ajaxurl})}),e(document).on("click",".ezfc-fileupload-files-remove",function(){var a=e(this);if(a.hasClass("ezfc-state-removing"))return!1;var i=a.closest(".ezfc-form"),r=i.find("input[name='id']").val(),n=a.closest(".ezfc-element"),s=a.closest(".ezfc-fileupload-files-item"),o=n.find(".ezfc-fileupload-message"),c=n.find(".ezfc-element-fileupload"),l=n.data("id"),d=s.data("fileid"),f=s.data("refid"),u="action=remove_uploaded_file&file_id="+d+"&ref_id="+f;return a.addClass("ezfc-state-removing"),a.find(".fa").removeClass("fa-close").addClass("fa-circle-o-notch fa-spin"),e.ajax({type:"post",url:ezfc_vars.ajaxurl,data:{action:"ezfc_frontend_fileupload",data:u},complete:function(i){var f;if("object"==typeof i&&"undefined"!=typeof i.responseText)try{f=e.parseJSON(i.responseText)}catch(u){}if(!f)return o.text(i.upload_remove_error),a.find(".fa").removeClass("fa-circle-o-notch fa-spin ezfc-state-removing").addClass("fa-close"),!1;if(!c.attr("multiple")){var _=n.find(".ezfc-fileupload-files-item").length;1==_&&c.removeAttr("disabled")}s.fadeOut(),o.text(ezfc_vars.upload_removed);for(var p in t.uploaded_files[r][l])t.uploaded_files[r][l][p].id==d&&t.uploaded_files[r][l].splice(p,1)}}),!1}),e(".ezfc-overview").dialog({autoOpen:!1,modal:!0}),e(".ezfc-form .ezfc-input-format-listener").each(function(){t.input_format_listener_change(e(this)),e(this).trigger("blur")});var a=this.throttle(function(e){var a=e.parents(".ezfc-form");t.form_change(a)},100);e(document).on("change keyup",".ezfc-form input, .ezfc-form select",function(){a(e(this))}),e(".ezfc-element-wrapper-checkbox").change(function(){t.checkbox_change(e(this))}),e(".ezfc-slider").each(function(a,i){var r=e(this),n=(e(this).closest(".ezfc-form").data("id"),e(i).siblings(".ezfc-slider-element")),s=r.hasClass("ezfc-slider-vertical")?"vertical":"horizontal",o=t.normalize_value(r.val(),r),c=n.slider({min:r.data("min")||0,max:r.data("max")||100,step:r.data("stepsslider")||1,value:o||0,orientation:s,slide:function(e,a){var i=t.normalize_value(a.value,r);r.val(i),r.trigger("change")},start:function(){r.trigger("focus")},stop:function(){r.trigger("blur")}});if(e(document).on("change keyup",r,function(){var e=t.normalize_value(r.val(),r);c.slider("value",e)}),r.hasClass("ezfc-pips")){var l={rest:"label"};isNaN(r.data("stepspips"))||""==r.data("stepspips")||(l.step=r.data("stepspips")),n.slider("pips",l),n.find(".ui-slider-pip").on("click",function(){var t=e(this).find(".ui-slider-label").data("value");r.val(t),r.trigger("change")}),1==r.data("pipsfloat")&&n.slider("float")}}),e(".ezfc-spinner").each(function(){var a=e(this);a.spinner({min:a.data("min")||0,max:a.data("max")||100,step:a.data("stepsspinner")||1,change:function(){a.trigger("change")},spin:function(e,i){var r=t.normalize_value(i.value,a);a.val(r),a.trigger("change")},start:function(){var e=t.normalize_value(a.val(),a);a.val(e)},stop:function(){var e=t.normalize_value(a.val(),a);a.val(e)}})}),e(".ezfc-step-button").on("click",function(){var a=e(this).parents(".ezfc-form"),i=parseInt(a.find(".ezfc-step-active").data("step")),r=i+(e(this).hasClass("ezfc-step-next")?1:-1),n=e(this).hasClass("ezfc-step-next")?1:0;return t.set_step(a,r,n),!1}),e(".ezfc-step-indicator-item-active").on("click",function(){var a=e(this).closest(".ezfc-form"),i=parseInt(e(this).data("step"));return t.set_step(a,i,0),!1}),e(".ezfc-element-wrapper-payment input").on("change",function(){var a=e(this).closest(".ezfc-form"),i=a.data("id");1==t.form_vars[i].price_show_request||t.form_vars[i].summary_enabled||t.set_submit_text(a)}),e(window).scroll(this.scroll),this.scroll(),e(".ezfc-form").submit(function(a){var i=e(this),r=i.data("id"),n=i.find(".ezfc-submit");return 1==t.form_vars[r].hard_submit?!0:(t.form_submit(i,-1,n.data("type")),a.preventDefault(),!1)}),e(".ezfc-payment-submit").click(function(a){var i=e(this).closest(".ezfc-payment-form"),r=i.data("form_id"),n=e(".ezfc-form[data-id='"+r+"']");return t.form_submit(n,-1,e(this).data("payment")),a.preventDefault(),!1}),e(".ezfc-payment-cancel").click(function(){var a=e(this).closest(".ezfc-payment-form"),i=a.data("form_id"),r=e("#ezfc-form-"+i),n=".ezfc-payment-dialog-modal[data-form_id='"+i+"']";return n+=", .ezfc-payment-form",e(n).removeClass("ezfc-payment-dialog-open"),t.form_submit(r,!1,!1,!0),!1}),e(".ezfc-reset").click(function(){var a=e(this).parents(".ezfc-form");return t.reset_form(a),!1}),e(".ezfc-collapse-title-wrapper").on("click",function(){var a=e(this).closest(".ezfc-element-wrapper-group");t.toggle_group(a)}),e(".ezfc-cc-number-formatter").on("change keyup",function(){var t=e(this).val();t=t.replace(/[^\dA-Z]/g,"").replace(/(.{4})/g,"$1 ").trim(),e(this).val(t)}),e(".ezfc-group-repeat").on("click",function(){return t.group_repeat(e(this).data("group_repeat_id")),!1})},this.init_form_ui=function(a,i){"undefined"==typeof i&&(i=!0);var r=e(a),n=r.data("id");r.find(".ezfc-element-datepicker").each(function(){var a=e(this),i={};a.data("settings")&&(i=a.data("settings"));var r=[0,1,2,3,4,5,6];i.available_days.length&&(r=i.available_days.split(",")),r=r.map(function(e){return parseInt(e)});var s=[];i.blocked_days.length&&(s=i.blocked_days.split(",")),a.datepicker({dateFormat:t.form_vars[n].datepicker_format,minDate:i.minDate?i.minDate:"",maxDate:i.maxDate?i.maxDate:"",numberOfMonths:i.numberOfMonths?parseInt(i.numberOfMonths):1,showAnim:i.showAnim?i.showAnim:"fadeIn",showWeek:"1"==i.showWeek?i.showWeek:!1,firstDay:i.firstDay?i.firstDay:!1,beforeShowDay:function(e){return t.check_datepicker_days(e,r,s)}}),"__today__"==a.val()&&a.datepicker("setDate",new Date)}),r.find(".ezfc-element-daterange").each(function(){var a=e(this),i=a.closest(".ezfc-element-daterange-container").data("settings"),r=[0,1,2,3,4,5,6];i.available_days.length&&(r=i.available_days.split(",")),r=r.map(function(e){return parseInt(e)});var s=[];i.blocked_days.length&&(s=i.blocked_days.split(",")),a.hasClass("ezfc-element-daterange-from")?(a.datepicker({dateFormat:t.form_vars[n].datepicker_format,minDate:a.data("mindate"),maxDate:a.data("maxdate"),numberOfMonths:i.numberOfMonths?parseInt(i.numberOfMonths):1,showAnim:i.showAnim?i.showAnim:"fadeIn",showWeek:"1"==i.showWeek?i.showWeek:!1,firstDay:i.firstDay?i.firstDay:!1,onSelect:function(i){var r=a.data("mindays")||0,s=a.data("maxdays")||0,o=e.datepicker.parseDate(t.form_vars[n].datepicker_format,i);o.setDate(o.getDate()+r);var c=e.datepicker.parseDate(t.form_vars[n].datepicker_format,i);c.setDate(c.getDate()+s),a.siblings(".ezfc-element-daterange-to").datepicker("option","minDate",o),0!=s&&a.siblings(".ezfc-element-daterange-to").datepicker("option","maxDate",c),a.trigger("change")},beforeShowDay:function(e){return t.check_datepicker_days(e,r,s)}}),"__today__"==a.val()&&a.datepicker("setDate",new Date)):(a.datepicker({dateFormat:t.form_vars[n].datepicker_format,minDate:a.data("mindate"),maxDate:a.data("maxdate"),numberOfMonths:i.numberOfMonths?parseInt(i.numberOfMonths):1,showAnim:i.showAnim?i.showAnim:"fadeIn",showWeek:"1"==i.showWeek?i.showWeek:!1,firstDay:i.firstDay?i.firstDay:!1,onSelect:function(){a.trigger("change")},beforeShowDay:function(e){return t.check_datepicker_days(e,r,s)}}),"__today__"==a.val()&&a.datepicker("setDate",new Date))}),r.find(".ezfc-element-timepicker").each(function(){var a=e(this),i={};a.data("settings")&&(i=a.data("settings")),a.timepicker({minTime:i.minTime?i.minTime:null,maxTime:i.maxTime?i.maxTime:null,step:i.steps?i.steps:30,timeFormat:i.format?i.format:t.form_vars[n].timepicker_format})}),r.find(".ezfc-element-colorpicker").each(function(){var t=e(this),a=t.parents(".ezfc-element").find(".ezfc-element-colorpicker-input"),i=t.colorpicker({container:t}).on("changeColor.colorpicker",function(e){t.css("background-color",e.color.toHex()),a.val(e.color.toHex())});e(a).on("click focus",function(){i.colorpicker("show")}).on("change",function(){i.colorpicker("setValue",r.val())})});var s=r.find(".ezfc-step");if(s.length>0){var o=s.last();r.find(".ezfc-summary-wrapper").appendTo(o),r.find(".ezfc-submit-wrapper").appendTo(o).addClass("ezfc-submit-step"),this.prevent_enter_step_listener(o.find("input"),r)}e(".ezfc-custom-element[data-group]").each(function(){var t=e(this),a=(t.data("id"),t.data("group")),i=e("#ezfc_element-"+a);if("group"==i.data("element")&&i.length>0){var r=i.find("> .ezfc-group-elements");t.appendTo(r)}}),t.init_form(a)},this.init_form=function(a){var i=e(a),r=i.data("id");this.form_vars[r]=i.data("vars"),"object"!=typeof this.form_vars[r]&&(this.form_vars[r]=e.parseJSON(i.data("vars"))),t.$form_elements[r]=[];for(var n in t.form_vars[r].form_elements_order)t.$form_elements[r].push(e("#ezfc_element-"+t.form_vars[r].form_elements_order[n]));if(this.subtotals[r]=[],this.conditional_once[r]=[],this.external_listeners[r]=[],this.elements_cache[r]=[],1==this.form_vars[r].price_show_request&&this.price_request_toggle(r,!1),this.set_price(i),this.set_submit_text(i),this.form_vars[r].use_woocommerce){var s=".woocommerce form.cart, .woocommerce .price";e(s).hide()}var o=parseInt(this.form_vars[r].step_indicator_start)+1;o>1&&i.find(".ezfc-step-indicator").hide(),2!=ezfc_vars.debug_mode||e("#ezfc-show-all-elements").length||(i.append("<button id='ezfc-show-all-elements'>Show/hide elements</button>"),e("#ezfc-show-all-elements").click(function(){return i.hasClass("ezfc-debug-visible")?(i.removeClass("ezfc-debug-visible"),i.find(".ezfc-tmp-visible").removeClass("ezfc-tmp-visible").hide()):(i.addClass("ezfc-debug-visible"),i.find(".ezfc-hidden").addClass("ezfc-tmp-visible").show().css("display","inline-block")),!1})),this.form_vars[r].use_stripe&&"undefined"!=typeof Stripe&&Stripe.setPublishableKey(ezfc_vars.stripe.publishable_key),this.prevent_enter_step_listener(":input:not(textarea):not([type=submit])",i),this.populate_html_placeholders(i),e(document).trigger("ezfc_form_init",r)},this.form_change=function(t){var a=e(t).data("id");return this.clear_hidden_values(t),this.form_vars[a].price_requested=0,this.form_vars[a].summary_shown=0,e(t).find(".ezfc-summary-wrapper").fadeOut(),1==this.form_vars[a].price_show_request?(this.price_request_toggle(a,!1),!1):(this.remove_debug_info(),this.set_price(t),this.set_submit_text(t),void this.populate_html_placeholders(t))},this.form_submit=function(a,i,r,n){var s=e(a),o=s.closest(".ezfc-wrapper"),c=s.data("id"),l=!1;s.find(".ezfc-submit-icon").addClass("ezfc-submit-icon-show");var d=s.find(".ezfc-submit-icon, .ezfc-step-submit-icon"),f=s.find("input[type='submit']");if(1==this.form_vars[c].price_show_request&&this.set_price(a),n)return t.submit_cancel(s),!1;if(-1!==e.inArray(r,t.payment_methods)){var u=e("#ezfc-"+r+"-form-"+c),_=this.format_price(c,this.price_old_global[c],!1,!1,!0);if(u.find(".ezfc-payment-price").text(_),t.form_vars[c].payment_info_shown[r]){if(t.payment_form_id=c,u.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!0),"stripe"==r)Stripe.card.createToken(u,this.stripe_response_handler);else if("authorize"==r){if("undefined"==typeof Accept)return t.debug_message("AcceptJS wasn't loaded."),!1;this.authorize_create_token(c)}}else t.form_vars[c].payment_info_shown[r]=1,e("#ezfc-"+r+"-form-"+c+", #ezfc-"+r+"-form-modal-"+c).addClass("ezfc-payment-dialog-open");return d.fadeOut(),!1}d.fadeIn(),f.prop("disabled",!0),s.find(".ezfc-custom-hidden:not(.ezfc-element-wrapper-fileupload):not(.ezfc-element-wrapper-group)").each(function(){var t=e(this).find(".ezfc-element-radio:not(:has(:radio:checked))");t.length&&e(t).first().find("input").prop("checked",!0),e(this).find("input, :selected").val("__HIDDEN__").removeAttr("disabled").addClass("ezfc-has-hidden-placeholder")}),s.find(".ezfc-element[data-calculate_activated='0']").each(function(){e(this).find("input, :selected").val("__HIDDEN__")}),s.find(".ezfc-element-wrapper-checkbox").each(function(){if(e(this).find(".ezfc-has-hidden-placeholder").length)return!1;var a=e(this),i=parseInt(a.attr("data-min_selectable")),r=parseInt(a.attr("data-max_selectable")),n=a.find(":checked").length;return i>0&&i>n?(l=!0,t.show_tip(a,"#"+a.attr("id"),0,t.sprintf(t.form_vars[c].selectable_min_error,i)),!1):r>0&&n>r?(l=!0,t.show_tip(a,"#"+a.attr("id"),0,t.sprintf(t.form_vars[c].selectable_max_error,r)),!1):void 0});var p=[];s.find("[data-is_number='1'] input").each(function(){"__HIDDEN__"!=this.value&&(p.push({element:e(this),value:this.value}),this.value=this.value.replace(/[^0-9\.,-]/g,""))});var m=s.serialize();return e.each(p,function(t,a){e(a.element).val(a.value)}),l?(d.fadeOut(),f.removeAttr("disabled"),!1):(m+="&url="+encodeURI(window.location.href),0==this.form_vars[c].price_requested&&(m+="&price_requested=1"),0==this.form_vars[c].summary_shown&&(m+="&summary=1"),-1!=i&&(m+="&step="+i),this.form_vars[c].preview_form&&(m+="&preview_form="+this.form_vars[c].preview_form),m+="&generated_price="+this.price_old_global[c],this.call_hook("ezfc_before_submission",{data:m,form:s,form_vars:this.form_vars[c],id:c}),void e.ajax({type:"post",url:ezfc_vars.ajaxurl,data:{action:"ezfc_frontend",data:m},success:function(r){e(".ezfc-submit-icon").removeClass("ezfc-submit-icon-show"),f.removeAttr("disabled"),d.fadeOut(),t.debug_message(r);try{r=e.parseJSON(r)}catch(n){r=!1,t.debug_message(n)}if(!r)return s.find(".ezfc-message").text("Something went wrong. :("),t.recaptcha_reload(),t.reset_disabled_fields(a,!0),!1;if("undefined"!=typeof r.error){if(t.reset_disabled_fields(a,!0),r.id){var l=!0,u="#ezfc_element-"+r.id,_=e(u).find(".ezfc-element").first(),p=null,h=s.find(".ezfc-step-active").length>0?!0:!1;if(h){var v=parseInt(e(u).parents(".ezfc-step").data("step"));v!=i&&-1!=i&&(l=!1,t.set_step(a,i+1))}if(l){_.length||(_=e(u));var g=h?1e3:400,b=o.find(".ezfc-payment-dialog-open").length>0;if(_.is(":visible"))t.show_tip(_,u,g,r.error),b&&t.set_message(c,r.error+" (#"+r.id+")");else{var z=_.parents(".ezfc-element-wrapper-group");z.length?(z.each(function(a,i){t.toggle_group(e(i),!0)}),t.show_tip(_,u,g,r.error)):t.set_message(c,r.error+" (#"+r.id+")")}if("undefined"!=typeof ezfc_vars.required_text_auto_hide){var y=1e3*parseFloat(ezfc_vars.required_text_auto_hide);y>0&&setTimeout(function(){p&&p.hide()},y)}0==t.form_vars[c].disable_error_scroll&&t.scroll_to(u)}}else t.set_message(c,r.error);return t.recaptcha_reload(),!1}if(r.step_valid)return t.reset_disabled_fields(a),t.set_step(a,i+1),!1;if(r.summary)return s.find(".ezfc-summary-wrapper").fadeIn().find(".ezfc-summary").html(r.summary),t.form_vars[c].summary_shown=1,t.reset_disabled_fields(a),!1;if(t.recaptcha_reload(),r.paypal)f.attr("disabled","disabled"),window.location.href=r.paypal;else{if(r.price_requested||0===r.price_requested)return t.price_request_toggle(c,!0,r.price_requested),!1;var k={data:m,form:s,form_vars:t.form_vars[c],id:c,price:price,response:r};t.call_hook("ezfc_submission_success",k),t.form_vars[c].submission_js_func&&"function"==typeof window[t.form_vars[c].submission_js_func]&&window[t.form_vars[c].submission_js_func](k),o.find(".ezfc-payment-dialog, .ezfc-payment-dialog-modal").removeClass("ezfc-payment-dialog-open");var w=e(".ezfc-success-text[data-id='"+c+"']");if(w.html(r.success),1==t.form_vars[c].reset_after_submission)return t.reset_form(a),void w.fadeIn().delay(7500).fadeOut();if(1==t.form_vars[c].hide_all_forms?e(".ezfc-form, .ezfc-required-notification").fadeOut():(s.find(".ezfc-required-notification").fadeOut(),1==t.form_vars[c].show_success_text&&s.fadeOut()),1==t.form_vars[c].show_success_text&&(1==t.form_vars[c].scroll_to_success_message?w.fadeIn(400,function(){t.scroll_to(w,-200)}):w.fadeIn()),r.woo_update_cart&&r.woo_cart_html&&ezfc_vars.woocommerce_update_cart_selector.length>0&&e(ezfc_vars.woocommerce_update_cart_selector).html(r.woo_cart_html),"undefined"!=typeof t.form_vars[c].redirect_url&&t.form_vars[c].redirect_url.length>0){var x="";1==t.form_vars[c].redirect_forward_values&&(x=s.serialize(),x+="&total="+t.price_old_global[c],x+="&total_f="+t.functions.price_format(c,t.price_old_global[c]));var C=-1==t.form_vars[c].redirect_url.indexOf("?")?"?":"&";window.location.href=t.form_vars[c].redirect_url+C+x}else if("undefined"!=typeof t.form_vars[c].refresh_page_after_submission&&1==t.form_vars[c].refresh_page_after_submission){var D=Math.max(0,Math.abs(parseInt(t.form_vars[c].redirect_timer)));setTimeout(function(){window.location.reload()},1e3*D)}}}}))},this.calculate_get_external_values=function(a,i,r,n){var s=r.data("value_external"),o=r.data("value_external_listen");if((!this.external_listeners[i][s]||o)&&s&&e(s).length>0){var c;c=e(s).is("input[type='radio']")?e(s).find(":checked").val():e(s).is("input, input[type='text'], textarea")?e(s).val():e(s).is("select")?e(s).find(":selected").text():e(s).text(),"input"==n||"numbers"==n||"subtotal"==n?r.find("input").val(c):"dropdown"==n?(r.find(":selected").removeAttr("selected"),r.find("option[value='"+c+"']").attr("selected","selected")):"radio"==n?(r.find(":checked").removeAttr("checked"),r.find("input[value='"+c+"']").attr("checked","checked")):"checkbox"==n?(r.find(":checked").removeAttr("checked"),r.find("input[value='"+c+"']").attr("checked","checked")):"textfield"==n&&r.find("textarea").val(c),this.external_listeners[i][s]||(this.external_listeners[i][s]=1,e(s).on("change keyup",function(){t.set_price(e(a))}))}},this.calculate_conditionals=function(a,i,r,n){var s=r.data("id");if(s&&"undefined"!=typeof ezfc_vars.element_vars[i][s].conditional){var o=ezfc_vars.element_vars[i][s].conditional,c=r.data("is_number"),l=this.get_value_from_element(r,null,!c),d=1;e.each(o.action,function(f,u){if(u&&0!=u){var _;if(_="submit_button"==o.target[f]?e(a).find(".ezfc-submit"):"price"==o.target[f]?e(a).find(".ezfc-price-wrapper-element"):e("#ezfc_element-"+o.target[f]),!(_.length<1&&o.redirects.length<1)){1==o.use_factor[f]&&(d=parseFloat(d),isNaN(d)||(l*=d));var p=[{operator:o.operator[f],value:o.values[f],compare_target:""}];"undefined"!=typeof o.chain&&"undefined"!=typeof o.chain[f]&&e.each(o.chain[f].operator,function(e){p.push({operator:o.chain[f].operator[e],value:o.chain[f].value[e],compare_target:o.chain[f].compare_target[e]})});var m=!1,h=0;e.each(p,function(a,d){var u=!1,p=d.value,v=[],g=l;0!=d.compare_target&&""!=d.compare_target&&(g=t.get_value_from_element(!1,d.compare_target)),"__self__"==d.value&&(d.value=l);var b=["in","not_in","selected","not_selected","selected_index","not_selected_index","selected_id","not_selected_id","selected_count","not_selected_count"];if(p=1==c&&-1===e.inArray(d.operator,b)?parseFloat(d.value):d.value,("between"==d.operator||"not_between"==d.operator)&&(v=d.value.split(":"),v.length>1&&(v[0]=parseFloat(v[0]),v[1]=parseFloat(v[1]))),"input"==n)u=p.toLowerCase()==_.val().toLowerCase();else switch(d.operator){case"gr":u=g>p;break;case"gre":u=g>=p;break;case"less":u=p>g;break;case"lesse":u=p>=g;break;case"equals":u=g==p;break;case"between":u=v.length<2?!1:g>=v[0]&&g<=v[1];break;case"not_between":u=v.length<2?!1:g<v[0]||g>v[1];break;case"not":u=v.length<2?g!=p:g<v[0]&&g>v[1];break;case"hidden":u=!t.element_is_visible(i,s);break;case"visible":u=t.element_is_visible(i,s);break;case"mod0":u=g>0&&g%p==0;break;case"mod1":u=g>0&&g%p!=0;break;case"bit_and":u=g&p;break;case"bit_or":u=g|p;break;case"empty":"undefined"==typeof g&&(u=!0),u="number"==typeof g?isNaN(g):g.length<1;break;case"notempty":u="undefined"==typeof g?!1:"number"==typeof g?!isNaN(g):g.length>0;break;case"in":if("undefined"==typeof g)u=!1;else{var z=p.split("|");u=!1;for(var y in z)if(g==z[y])return void(u=!0)}break;case"not_in":if("undefined"==typeof g)u=!1;else{var z=p.split("|");u=!0;for(var y in z)if(g==z[y])return void(u=!1)}break;case"once":u=!0,"undefined"==typeof t.conditional_once[i][s]&&(t.conditional_once[i][s]=[]),"undefined"==typeof t.conditional_once[i][s][f]&&(t.conditional_once[i][s][f]=[]),"undefined"==typeof t.conditional_once[i][s][f][a]?t.conditional_once[i][s][f][a]=1:u=!1;break;case"selected":case"selected_index":case"selected_id":case"selected_count":case"selected_count_gt":case"selected_count_lt":u=!1;var k="value";"selected_index"==d.operator?k="index":"selected_id"==d.operator?k="option_id":("selected_count"==d.operator||"selected_count_gt"==d.operator||"selected_count_lt"==d.operator)&&(k="count");var w;if(w=0!=d.compare_target&&""!=d.compare_target?t.get_value_from_element(!1,d.compare_target,!0,!1,{return_array:!0,return_value:k}):t.get_value_from_element(r,null,!0,!1,{return_array:!0,return_value:k}),"object"==typeof w){var z=p.split("|");for(var y in z){cmp_value=z[y];for(var x in w)w[x]==cmp_value&&(u=!0)}}else u="selected_count"==d.operator?w==p:"selected_count_gt"==d.operator?w>p:"selected_count_lt"==d.operator?p>w:w==p;break;case"not_selected":case"not_selected_index":case"not_selected_id":case"not_selected_count":u=!0;var k="value";"not_selected_index"==d.operator?k="index":"not_selected_id"==d.operator?k="option_id":"not_selected_count"==d.operator&&(k="count");var w;if(w=0!=d.compare_target&&""!=d.compare_target?t.get_value_from_element(!1,d.compare_target,!0,!1,{return_array:!0,return_value:k}):t.get_value_from_element(r,null,!0,!1,{return_array:!0,return_value:k}),"object"==typeof w){var z=p.split("|");for(var y in z){cmp_value=z[y];for(var x in w)if(w[x]==cmp_value)return void(u=!1)}}else u=w!=p;break;case"focus":u=r.find("input").is(":focus");break;case"blur":u=!r.find("input").is(":focus");break;case"always":u=!0;break;default:u=!1}if("undefined"!=typeof o.row_operator[f]&&1==o.row_operator[f]){if(u)return h++,m=!0,!1}else{if(!u)return;h++}}),h>0&&h==p.length&&(m=!0);var v,g,b=o.notoggle[f],z=_.data("element"),y=o.target_value[f];if(y=y.replace("__self__",l),"group"==z&&_.push(e(_).find("> .ezfc-custom-element")),"set"==u&&m){var k=o.target_value[f].toString().charAt(0);if(-1!==e.inArray(k,["+","-","*","/"])){var w,x=y.substring(1),C=t.get_value_from_element(_,null,!1,!0,{return_value:"base"});"__self__"==x&&(x=l),x=parseFloat(x),"+"==k?w=C+x:"-"==k?w=C-x:"*"==k?w=C*x:"/"==k&&(w=C/x),y=w}"input"==z||"hidden"==z||"numbers"==z||"subtotal"==z||"set"==z?_.find("input").val(y).trigger("blur"):"dropdown"==z?(_.find(":selected").removeAttr("selected"),_.find("option[data-value='"+y+"']").prop("selected","selected")):"radio"==z?t.radio_change_state(_.find("input[data-value='"+y+"']"),!0):"checkbox"==z?t.checkbox_change_state(_.find("input[data-value='"+y+"']"),!0):_.text(y)}else if("set_factor"==u&&m)_.find("[data-factor]").data("factor",y);else if("select_option"==u&&m)"radio"==z?t.radio_change_state(_.find("input[data-optionid='"+y+"']"),!0):"checkbox"==z?t.checkbox_change_state(_.find("input[data-optionid='"+y+"']"),!0):"dropdown"==z&&(_.find(":selected").removeAttr("selected"),_.find("option[data-optionid='"+y+"']").prop("selected","selected"));else if("deselect_option"==u&&m)"radio"==z?t.radio_change_state(_.find("input[data-optionid='"+y+"']"),!1):"checkbox"==z?t.checkbox_change_state(_.find("input[data-optionid='"+y+"']"),!1):"dropdown"==z&&_.find(":selected").removeAttr("selected");else if("show_option"==u)m?"radio"==z||"checkbox"==z?_.find("input[data-optionid='"+y+"']").closest(".ezfc-element-single-option-container").show():"dropdown"==z&&_.find("option[data-optionid='"+y+"']").removeAttr("hidden"):"radio"==z?(t.radio_change_state(_.find("input[data-optionid='"+y+"']"),!1),_.find("input[data-optionid='"+y+"']").closest(".ezfc-element-single-option-container").hide()):"checkbox"==z?(t.checkbox_change_state(_.find("input[data-optionid='"+y+"']"),!1),_.find("input[data-optionid='"+y+"']").closest(".ezfc-element-single-option-container").hide()):"dropdown"==z&&(_.find(":selected").removeAttr("selected"),_.find("option[data-optionid='"+y+"']").attr("hidden",!0));else if("hide_option"==u)m?"radio"==z?(t.radio_change_state(_.find("input[data-optionid='"+y+"']"),!1),_.find("input[data-optionid='"+y+"']").closest(".ezfc-element-single-option-container").hide()):"checkbox"==z?(t.checkbox_change_state(_.find("input[data-optionid='"+y+"']"),!1),_.find("input[data-optionid='"+y+"']").closest(".ezfc-element-single-option-container").hide()):"dropdown"==z&&_.find("option[data-optionid='"+y+"']").attr("hidden",!0).removeAttr("selected"):"radio"==z||"checkbox"==z?_.find("input[data-optionid='"+y+"']").closest(".ezfc-element-single-option-container").show():"dropdown"==z&&_.find("option[data-optionid='"+y+"']").removeAttr("hidden");else if("activate"==u){if(m)if("submit"==z)_.prop("disabled",!1);else if("group"==z){var D=_.find("[data-calculate_enabled]");D.data("calculate_enabled",1),D.attr("data-calculate_activated",1)}else _.data("calculate_enabled",1),_.attr("data-calculate_activated",1);else if(1!=b)if("submit"==z)_.prop("disabled",!0);else if("group"==z){var D=_.find("[data-calculate_enabled]");D.data("calculate_enabled",0),D.attr("data-calculate_activated",0)}else _.data("calculate_enabled",0),_.attr("data-calculate_activated",0)}else if("activate_option"==u){var N="[data-optionid='"+o.option_index_value[f]+"']";m?_.find(N).prop("disabled",!1).removeClass("force-disabled"):_.find(N).prop("disabled",!0).addClass("force-disabled")}else if("deactivate"==u){if(m){if("submit"==z)_.prop("disabled",!0);else if("group"==z){var D=_.find("[data-calculate_enabled]");D.data("calculate_enabled",0),D.attr("data-calculate_activated",0)}else _.data("calculate_enabled",0);_.attr("data-calculate_activated",0)}else if(1!=b)if("submit"==z)_.prop("disabled",!1);else if("group"==z){var D=_.find("[data-calculate_enabled]");D.data("calculate_enabled",1),D.attr("data-calculate_activated",1)}else _.data("calculate_enabled",1),_.attr("data-calculate_activated",1)}else if("deactivate_option"==u){var F="[data-optionid='"+o.option_index_value[f]+"']";m?_.find(F).prop("disabled",!0).addClass("force-disabled"):_.find(F).prop("disabled",!1).removeClass("force-disabled")}else if("redirect"==u&&m){var I=e(a).parents(".ezfc-wrapper").find(".ezfc-message");I.text(t.form_vars[i].redirect_text).fadeIn(),e(a).fadeOut(),setTimeout(function(){window.location.href=o.redirects[f]},1e3*t.form_vars[i].redirect_timer)}else if("step_goto"!=u&&"step_prev"!=u&&"step_next"!=u||!m)if("set_min_selectable"==u&&m)_.attr("data-min_selectable",y),t.checkbox_change(_);else if("set_max_selectable"==u&&m)_.attr("data-max_selectable",y),t.checkbox_change(_);else if("add_class"==u){var A=m?"addClass":"removeClass";_[A](y)}else if("remove_class"==u){var A=m?"removeClass":"addClass";_[A](y)}else if("set_color"==u&&m)_.find("input, select, .ezfc-price, .ezfc-element-checkbox-text").css("color",y),"submit"==z&&_.css("color",y);else{if("show"==u)v="removeClass",g="addClass";else{if("hide"!=u)return;v="addClass",g="removeClass"}m?(_[v]("ezfc-hidden ezfc-custom-hidden"),"show"==u?_.addClass("ezfc-fade-in"):_.is(":visible")&&_.fadeOut(500,function(){_.removeClass("ezfc-fade-in"),1==t.form_vars[i].clear_selected_values_hidden&&t.clear_hidden_values_element()})):1!=b&&(_[g]("ezfc-hidden ezfc-custom-hidden"),"show"==u?_.removeClass("ezfc-fade-in"):_.addClass("ezfc-fade-in"))}else{var q=parseInt(e(a).find(".ezfc-step-active").data("step")),O=0;switch(u){case"step_prev":if(0==q)return;O=q-1;break;case"step_next":var T=e(a).find(".ezfc-step-start").length;if(q==T-1)return;O=q+1;break;case"step_goto":var S=e(a).find(".ezfc-step-start[data-id='"+o.target[f]+"']");if(S.length<1)return;O=parseInt(S.data("step"))}t.set_step(e(a),O,0)}}}})}},this.calculate_element=function(a,i,r){var n=e("#ezfc-form-"+a),s=e("#ezfc_element-"+i),o=ezfc_vars.element_vars[a][i];if(!n||!s)return void console.log("Unable to find form #"+a+" or element #"+i);var c="undefined"==typeof o.calculate?[]:o.calculate,l=s.data("calculate_enabled"),d=s.data("add_to_price"),f=s.data("element"),u=(t.form_vars[a].has_steps,s.data("overwrite_price")),_=0;

("subtotal"==f||"custom_calculation"==f||"extension"==f)&&(_=r),("custom_calculation"==f||"extension"==f)&&(c=[]);var p=s.find(".ezfc-element-numbers, .ezfc-element-input-hidden, .ezfc-element-subtotal, .ezfc-element-daterange-container, .ezfc-element-set, .ezfc-element-extension, :selected, :checked, .ezfc-element-custom-calculation"),m=["ceil","floor","round","abs","subtotal"];return e(p).each(function(n,o){if("undefined"!=typeof c){var p={};e(this).data("settings")&&(p=e(this).data("settings"));var h=t.element_is_visible(a,i);if(!(h||p.hasOwnProperty("calculate_when_hidden")&&0!=p.calculate_when_hidden||"hidden"==f||"custom_calculation"==f))return void t.add_debug_info("calculate",s,"Skipped as element is hidden and calculate_when_hidden is not enabled.");if(!(l&&0!=l||c.targets||c.values||"set"==f||"subtotal"==f||"hidden"==f||"extension"==f||"custom_calculation"==f))return void t.add_debug_info("calculate",s,"No target or values were found to calculate with. Subtotal, Hidden and Set elements are skipped.");if((!l||0==l)&&"custom_calculation"!=f)return void t.add_debug_info("calculate",s,"Calculation is disabled.");var v=parseFloat(e(o).data("factor")),g=e(o).val(),b=t.get_value_from_element(s,null,!1),z=b/100,y=g.indexOf("%")>=0;(!b||isNaN(b))&&(b=0),v&&!isNaN(v)||0===v||(v=1);var k=b;switch(f){case"numbers":case"extension":case"hidden":k=b;break;case"dropdown":case"radio":case"checkbox":k=parseFloat(e(o).data("value")),isNaN(k)&&(k=0);break;case"subtotal":k=r;break;case"daterange":var w=[e(o).find(".ezfc-element-daterange-from").datepicker("getDate"),e(o).find(".ezfc-element-daterange-to").datepicker("getDate")];k=t.jqueryui_date_diff(w[0],w[1],e(o).data("workdays_only"))*v;break;case"custom_calculation":var x=e(s).find(".ezfc-element-custom-calculation").data("function");try{k=window[x](_)}catch(C){t.add_debug_info("custom_calculation",s,"--- Custom Calculation Error ---"),k=0}if(l&&(k=parseFloat(k)),e(s).find(".ezfc-element-custom-calculation-input").val(k),2==ezfc_vars.debug_mode){var D=e(s).find(".ezfc-element-custom-calculation script").text();t.add_debug_info("custom_calculation",s,"custom_calculation:\n"+D)}}if(y&&(k=_*z*100),"undefined"!=typeof c[0]){for(var N in c)if("__open__"==c[N].target&&"undefined"==typeof c[N].reference_index){c[N].prio=parseInt(c[N].prio),isNaN(c[N].prio)&&(c[N].prio=0);for(var F in c)N!=F&&(c[F].prio=parseInt(c[F].prio),isNaN(c[F].prio)&&(c[F].prio=0),"__close__"==c[F].target&&c[N].prio==c[F].prio&&"undefined"==typeof c[N].reference_index&&"undefined"==typeof c[F].reference_index&&(c[F].operator=c[N].operator,c[F].reference_index=N,c[N].reference_index=F))}e.each(c,function(i,n){if(!n.operator&&"__close__"!=n.target)return void t.add_debug_info("calculate",s,"#"+i+": No operator found here.");if("__open__"==n.target)return n.value=k,void(k=0);var l=[];if(-1===e.inArray(n.operator,m)&&"__open__"!=n.target&&"__close__"!=n.target&&(l=e("#ezfc_element-"+n.target),el_settings_target=l.find("input").data("settings"),l.hasClass("ezfc-custom-hidden")&&el_settings_target&&el_settings_target.hasOwnProperty("calculate_when_hidden")&&0==el_settings_target.calculate_when_hidden))return t.add_debug_info("calculate",s,"#"+i+": Skipping this element as it is conditionally hidden."),void(0==i&&"equals"==n.operator&&(k=0));var d,f=n.value,_=0;if("__close__"==n.target){if("undefined"==typeof c[n.reference_index])return;d=k,k=c[n.reference_index].value}else l.length>0?(_=l.data("id"),"undefined"==typeof n.use_calculated_target_value&&(n.use_calculated_target_value=0),0==n.use_calculated_target_value?d=t.get_value_from_element(l,null,!1):1==n.use_calculated_target_value?d=t.get_target_subtotal_value(a,_)+t.get_calculated_element_value(a,_):2==n.use_calculated_target_value?d=t.get_calculated_element_value(a,_):3==n.use_calculated_target_value&&(d=t.get_value_from_element(l,null,!1,!0))):0!=f&&(d=parseFloat(f));switch((!d||isNaN(d))&&(d=0),p.hasOwnProperty("precision")&&""!=p.precision&&(d=parseFloat(t.roundTo(d,p.precision))),n.operator){case"add":k+=d;break;case"subtract":k-=d;break;case"multiply":k*=d;break;case"divide":0==d?(t.add_debug_info("calculate",s,"#"+i+": Division by 0."),k=0):(k/=d,"1"==e(o).data("calculate_before")&&(u=1,k=d/b));break;case"equals":k=d;break;case"power":k=Math.pow(k,d);break;case"ceil":k=Math.ceil(k);break;case"floor":k=Math.floor(k);break;case"round":k=Math.round(k);break;case"abs":k=Math.abs(k);break;case"subtotal":k=r;break;case"log":if(0==d)return;k=Math.log(d);break;case"log2":if(0==d)return;k=Math.log2(d);break;case"log10":if(0==d)return;k=Math.log10(d);break;case"sqrt":k=Math.sqrt(k)}t.add_debug_info("calculate",s,"#"+i+": operator = "+n.operator+"\ntarget_value = "+d+"\ntarget_element = #"+_+"\ncalc_value = "+f+"\naddPrice = "+k)})}1==d?_+=k:2==d&&(_=k),1==u&&(_=k),t.add_debug_info("calculate",s,"===\nprice = "+_+"\naddPrice = "+k+"\nloop_price = "+r+"\nvalue = "+b+"\nfactor = "+v)}}),_},this.calculate_element_loop=function(e,t,a,i){e||(e=t.closest(".ezfc-form").data("id"));var r,n=t.data("calculate_enabled"),s=t.data("overwrite_price"),o=t.data("add_to_price"),c=t.data("is_number"),l=t.data("is_currency"),d=this.calculate_element(e,t.data("id"),i);if(1==n&&(o>=1?1==s?i=d:i+=d:1==s&&(r=d)),"subtotal"==a||"set"==a||"custom_calculation"==a){r=1==o?1==s?i:d:2==o?d:d;var f=2,u=t.find("input").data("settings");u&&(f=u.precision);var _=r;1==c&&(_=this.normalize_value(r,t,f),1==l&&(_=this.format_price(e,_,null,null,!0))),t.find("input").val(_)}return i},this.calculate_discounts=function(a,i,r,n,s){var o=r.data("id"),c=1==r.data("overwrite_price");if(!o||"undefined"==typeof ezfc_vars.element_vars[i][o].discount)return s;var l=ezfc_vars.element_vars[i][o].discount;if(l){var d=l.range_min,f=l.range_max,u=l.operator,_=l.values,p=0,m=1;if("input"==n||"numbers"==n||"subtotal"==n||"hidden"==n||"extension"==n){var h=r.find("input");m=parseFloat(h.data("factor")),m&&!isNaN(m)||0===m||(m=1),p=this.normalize_value(h.val(),r)}else if("dropdown"==n)p=parseFloat(r.find(":selected").data("value"));else if("radio"==n)p=parseFloat(r.find(":checked").data("value"));else if("checkbox"==n)p=0,r.find(":checked").each(function(t,a){p+=parseFloat(e(a).data("value"))});else if("daterange"==n){var v=[r.find(".ezfc-element-daterange-from").datepicker("getDate"),r.find(".ezfc-element-daterange-to").datepicker("getDate")];p=t.jqueryui_date_diff(v[0],v[1],r.data("workdays_only"))}e.each(u,function(a,i){if(!(_[a].length<1)){d[a]||0===d[a]||(d[a]=Number.NEGATIVE_INFINITY),f[a]||0===f[a]||(f[a]=Number.POSITIVE_INFINITY);var o;if(p>=parseFloat(d[a])&&p<=parseFloat(f[a])){var l,u=parseFloat(_[a]);switch(i){case"add":l=u,o=s+l,c?s=o:s+=o;break;case"subtract":l=u,o=s-l,c?s=o:s-=o;break;case"percent_add":l=p*m*(u/100),o=s+l,s=o;break;case"percent_sub":l=p*m*(u/100),o=s-l,s=o;break;case"equals":l=u,o=l,s=o;break;case"factor":l=p*u,o=l;var h=r.find("[data-factor]"),v=h.data("factor");v!=u&&(h.data("factor",u),h.trigger("change"),h.trigger("change"))}"subtotal"!=n||isNaN(o)||(o=t.normalize_value(o,r),e(r).find("input").val(o)),t.add_debug_info("discount",r,"discount = "+l+"\nprice after discount = "+s)}}})}return s},this.calculate_set_elements=function(a,i,r){var n,s=r.data("set_operator"),o=r.data("set_elements"),c=1==r.data("set_allow_zero"),l=r.data("set_dom_selector"),d=[];if(o||l){if(l)d=e(l);else{var f=o.toString().split(",");e.each(f,function(t,a){var i=e("#ezfc_element-"+a);i&&d.push(i)})}e.each(d,function(a,i){var r=e(i),o=t.get_value_from_element(r,null,!1);if(c||0!=o){if(0==a)return void(n=o);switch(s){case"min":n>o&&(n=o);break;case"max":o>n&&(n=o);break;case"avg":case"sum":n+=o;break;case"dif":n-=o;break;case"prod":n*=o;break;case"quot":0!=o&&(n/=o)}}}),"avg"==s&&(n/=d.length),n=this.normalize_value(n,r),r.find("input").val(n)}},this.calculate_price=function(a){var i=e(a).data("id"),r=0;return this.subtotals[i]=[],e.each(t.$form_elements[i],function(e){var n=t.$form_elements[i][e],s=n.data("id"),o=n.data("element"),c={};n.find("input").data("settings")&&(c=n.find("input").data("settings")),t.calculate_get_external_values(a,i,n,o),t.calculate_conditionals(a,i,n,o);var l=0;if("undefined"!=typeof c.calculate_when_hidden&&(l=parseInt(c.calculate_when_hidden)),t.element_is_visible(i,s)||l||"hidden"==o){t.calculate_set_elements(a,i,n,o);var d=t.calculate_element_loop(i,n,o,r);r=d,r=t.calculate_discounts(a,i,n,o,r),n.data("calculate_enabled")&&t.subtotals[i].push({el_id:s,price:r}),t.calculate_conditionals(a,i,n,o)}}),r},this.set_price=function(a,i,r){var n=e(a).data("id");return r?price=r:i&&0===i||(price=this.calculate_price(e(a))),this.set_subtotal_values(e(a)),1==this.form_vars[n].price_show_request&&0==this.form_vars[n].price_requested?void this.price_request_toggle(n,!1):("undefined"==typeof this.price_old_global[n]&&(this.price_old_global[n]=0),void(this.price_old_global[n]!=price&&(0!=this.form_vars[n].counter_duration?e(a).find(".ezfc-price-value").countTo({from:t.price_old_global[n],to:price,speed:this.form_vars[n].counter_duration,refreshInterval:this.form_vars[n].counter_interval,formatter:function(e){return t.format_price(n,e)}}):e(a).find(".ezfc-price-value").text(this.format_price(n,price)),this.price_old_global[n]=price)))},this.format_price=function(e,t,a,i,r){var n=this.defaultFormat,s=a||this.form_vars[e].currency;this.form_vars[e].price_format&&this.form_vars[e].price_format.length>0&&(n=this.form_vars[e].price_format),i&&i.length>0&&(n=i),isNaN(t)&&(t=0);var o=0;return isFinite(t)&&(o=numeral(t).format(n),1==ezfc_vars.price_format_replace_trailing_zeros.enabled&&parseFloat(t).toFixed(6)%1===0&&(o+=ezfc_vars.price_format_dec_point+ezfc_vars.price_format_replace_trailing_zeros.text)),r&&(0==this.form_vars[e].currency_position?o=s+o:o+=s),o},this.price_request_toggle=function(t,a,i){var r=e(".ezfc-form[data-id='"+t+"']");a?(this.price_old_global[t]=0,this.form_vars[t].price_requested=1,this.calculate_price(r),this.set_price(r,null,i),this.set_submit_text(r)):(this.form_vars[t].price_requested=0,e(r).find(".ezfc-price-value").text(this.form_vars[t].price_show_request_before),e(r).find(".ezfc-submit").val(this.form_vars[t].submit_text.request))},this.set_subtotal_values=function(a){var i=["subtotal","set","numbers","custom_calculation"];e(i).each(function(i,r){e(a).find("[data-element='"+r+"']").each(function(i,n){var s;s=e(n).find("custom_calculation"==r?".ezfc-element-custom-calculation-input":".ezfc-element-"+r);var o,c,l=t.normalize_value(s.val(),s),d=null;s.data("settings")&&(o=s.data("settings"),d=o.price_format),c=t.format_price(e(a).data("id"),l,null,d),e(n).find(".ezfc-text").text(c)})})},this.scroll=function(){e(".ezfc-fixed-price").each(function(){var a=e(this).data("id");if(t.form_vars[a]){var i="ezfc-fixed-price-scrolling",r=e(this).offset(),n=e(".ezfc-form[data-id='"+a+"']"),s=n.outerHeight(),o=n.offset(),c=e(window).scrollTop(),l=parseFloat(t.form_vars[a].price_position_scroll_top),d=o.top-c-l;0>d&&d>-s?(e(this).offset({top:c+l}),e(this).addClass(i)):d>0&&r.top>o.top&&(e(this).offset({top:o.top}),e(this).removeClass(i))}})},this.reset_disabled_fields=function(t,a){var i=e(t).closest(".ezfc-wrapper");e(t).find(".ezfc-custom-hidden").each(function(){e.each(e(this).find("input, :selected"),function(){e(this).val(e(this).data("index")).removeAttr("disabled")})}),i.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!1),this.set_submit_text(t,a)},this.reset_form=function(t){this.init_form(t),t.find(".ezfc-custom-element").each(function(){var t=e(this).data("element"),a=e(this).find("[data-initvalue]").data("initvalue");switch(t){case"checkbox":e(this).find("input").each(function(){a=e(this).data("initvalue"),1==a?e(this).prop("checked",!0):e(this).removeAttr("checked")});break;case"dropdown":e(this).find("option").removeAttr("selected"),e(this).find("option[data-index='"+a+"']").prop("selected",!0);break;case"numbers":e(this).find("input").val(a);var i=e(this).find(".ezfc-slider-element");i.length&&i.slider({value:a});break;case"radio":e(this).find("input").removeAttr("checked"),e(this).find("input[data-initvalue]").prop("checked",!0);break;case"textfield":e(this).find("textarea").val(a);break;default:e(this).find("input").val(a)}}),t.find(".ezfc-selected").removeClass("ezfc-selected"),this.set_step(t,0,0),this.form_change(t)},this.set_step=function(a,i,r){var n=parseInt(a.find(".ezfc-step-active").data("step")),s=a.find(".ezfc-step[data-step='"+n+"']"),o=a.data("id");if(n!=i){if(1==r&&1==this.form_vars[o].verify_steps){var c=a.find(".ezfc-step-submit-icon");return c.fadeIn(),this.form_submit(a,i-1),void e(".ezfc-has-hidden-placeholder").val("").removeClass("ezfc-has-hidden-placeholder")}var l=parseInt(this.form_vars[o].step_indicator_start)-1;return s.fadeOut(200,function(){var r=a.find(".ezfc-step[data-step='"+i+"']");r.fadeIn(200).addClass("ezfc-step-active"),e(this).removeClass("ezfc-step-active"),i>=l?a.find(".ezfc-step-indicator").fadeIn():a.find(".ezfc-step-indicator").hide(),t.scroll_to(r)}),a.find(".ezfc-step-indicator-item").each(function(){var t=parseInt(e(this).data("step"));e(this).removeClass("ezfc-step-indicator-item-active"),i>=t&&e(this).addClass("ezfc-step-indicator-item-active")}),!1}},this.scroll_to=function(t,a){var i=e(t).offset();if("undefined"!=typeof i&&0!=ezfc_vars.auto_scroll_steps){var r=parseFloat(a)||parseFloat(ezfc_vars.scroll_steps_offset)||50,n=i.top+r;e("html, body").animate({scrollTop:n})}},this.get_value_from_element=function(a,i,r,n,s){var o={return_array:!1,return_value:"value"};if(s=e.extend({},o,s),a||(a=e("#ezfc_element-"+i)),!a.length)return this.debug_message("Unable to find element #"+i),0;var c=a.find("input"),l=a.data("element"),d=1,f=a.find("input").val(),u=f?f.indexOf("%")>=0:0,_=this.normalize_value(f,a),p=_/100;(!_||isNaN(_))&&(_=0);var m=r?_:parseFloat(_);switch("count"==s.return_value&&(m=0),l){case"input":m=f;break;case"subtotal":case"numbers":case"hidden":case"extension":case"set":if(d=parseFloat(c.data("factor")),d&&!isNaN(d)||0===d||(d=1),"base"==s.return_value){var h=c.data("settings");_=f=h.value_base}m=r?f:n?_:_*d;break;case"dropdown":case"radio":case"checkbox":a.find(":selected, :checked").each(function(){if(r){var t=s.return_value;"object"!=typeof m&&"count"!=t&&(m=[]),"name"==t?m.push(e(this).text()):"option_id"==t?m.push(e(this).data("optionid")):"count"==t?m++:m.push(e(this).data(t))}else m+=parseFloat(e(this).data("value"))});break;case"daterange":var v=[a.find(".ezfc-element-daterange-from").datepicker("getDate"),a.find(".ezfc-element-daterange-to").datepicker("getDate")];if(d=parseFloat(a.find(".ezfc-element-daterange-from").data("factor")),d&&!isNaN(d)||0===d||(d=1),r)m=v;else{var g=t.jqueryui_date_diff(v[0],v[1],a.data("workdays_only"));m=n?g:g*d}break;case"custom_calculation":m=a.find(".ezfc-element-custom-calculation-input").val(),r||(m=parseFloat(m));break;case"starrating":m=parseFloat(a.find(":checked").val()),isNaN(m)&&(m=0)}return u&&(m=p),r?m:(isNaN(m)&&(m=0),m?parseFloat(m):0)},this.checkbox_change=function(e){var t=parseInt(e.attr("data-max_selectable"));if(t||e.find("input:not(:checked):not(.force-disabled)").removeAttr("disabled"),t&&t>=0){var a=e.find(":checked").length;a>=t?e.find("input:not(:checked)").attr("disabled","disabled"):e.find("input:not(:checked):not(.force-disabled)").removeAttr("disabled")}},this.checkbox_change_state=function(e,t,a){if(e.attr("disabled"))return!1;void 0===t&&(t=!e.is(":checked"));var i=e.closest(".ezfc-element-checkbox-container").hasClass("ezfc-element-option-has-image");if(i){var r=e.siblings(".ezfc-element-option-image");t?(e.attr("checked","checked"),r.addClass("ezfc-selected")):(e.removeAttr("checked"),r.removeClass("ezfc-selected"))}else e.prop("checked",t);a||e.trigger("change")},this.radio_change_state=function(e,t,a){if(e.attr("disabled"))return!1;void 0===t&&(t=!e.is(":checked"));var i=e.closest(".ezfc-element-radio-container"),r=i.closest(".ezfc-element-wrapper-radio");i.find(".ezfc-selected").removeClass("ezfc-selected"),i.find(".ezfc-element-radio-input").removeAttr("checked");var n=i.hasClass("ezfc-element-option-has-image");if(n){var s=e.siblings(".ezfc-element-option-image");t&&(e.attr("checked","checked"),r.find(".ezfc-selected").removeClass("ezfc-selected"),s.addClass("ezfc-selected"))}else t&&e.attr("checked","checked");a||e.trigger("change")},this.input_format_listener_change=function(e){var a=e.parent().closest(".ezfc-element"),i=e.closest(".ezfc-form").data("id"),r={},n="",s="";e.data("settings")&&(r=e.data("settings")),"undefined"!=typeof r.text_before&&(n=r.text_before),"undefined"!=typeof r.text_after&&(s=r.text_after),1==a.data("is_number")?e.on("focus click blur",function(){this.value=this.value.replace(/[^0-9\.,-]/g,"")}):e.on("focus click",function(){var e=t.escape_regex(n),a=t.escape_regex(s);this.value=this.value.replace(new RegExp("^"+e,""),""),this.value=this.value.replace(new RegExp(a+"$",""),"")}),1==a.data("is_currency")&&1==this.form_vars[i].format_currency_numbers_elements&&e.on("blur",function(){this.value=t.normalize_value(this.value,!1,!0,!1),this.value=t.format_price(i,this.value,null,null,!0)}),e.on("blur",function(){this.value=n+this.value+s})},this.element_is_visible=function(a,i){var r=e("#ezfc_element-"+i),n=t.form_vars[a].has_steps,s=r.is(":visible");return n&&!r.closest(".ezfc-step-active").length&&(s=!r.hasClass("ezfc-custom-hidden")),s},this.clear_hidden_values=function(t){var a=e(t).data("id");1==this.form_vars[a].clear_selected_values_hidden&&e(t).find(".ezfc-custom-hidden").each(function(){e(this).find("input[type='text']").val(""),e(this).find(":checkbox, :radio").prop("checked",!1)})},this.clear_hidden_values_element=function(e){var t=e.data("element");"input"==t||"numbers"==t||"subtotal"==t?cond_target.find("input").val(""):"dropdown"==t?cond_target.find(":selected").removeAttr("selected"):("radio"==t||"checkbox"==t)&&cond_target.find(":checked").removeAttr("checked")},this.escape_regex=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},this.normalize_value=function(a,i,r){if(a=String(a),"undefined"!=typeof i){var n,s=e(i);if(s.data("settings")?n=s.data("settings"):s.find("[data-settings]")&&(n=s.find("[data-settings]").data("settings")),"undefined"!=typeof n&&"undefined"!=typeof n.text_before&&"undefined"!==n.text_after){var o=t.escape_regex(n.text_before),c=t.escape_regex(n.text_after);a=a.replace(new RegExp("^"+o,""),""),a=a.replace(new RegExp(c+"$",""),"")}}var l=numeral(a).value();return"undefined"!=typeof r&&(l=l.toFixed(r)),l},this.set_submit_text=function(t,a){var i=e(t).data("id"),r=e(t).find(".ezfc-submit"),n="default",s=this.form_vars[i].submit_text["default"];if(1==this.form_vars[i].price_show_request){if((!this.form_vars[i].price_requested||a)&&(s=this.form_vars[i].submit_text.request,n="request"),a)return this.price_request_toggle(i,!1),!1}else if(1==this.form_vars[i].summary_enabled&&0==this.form_vars[i].summary_shown)n="summary",s=this.form_vars[i].submit_text.summary;else if(1==this.form_vars[i].use_paypal)n="paypal",s=this.form_vars[i].submit_text.paypal;else if(1==this.form_vars[i].payment_force_stripe)n="stripe",s=this.form_vars[i].submit_text.stripe;else if(1==this.form_vars[i].use_woocommerce)n="woocommerce",s=this.form_vars[i].submit_text.woocommerce;else{s=this.form_vars[i].submit_text["default"];var o=e(t).find(".ezfc-element-wrapper-payment");if(o.length>0){var c=e(o).find(":checked").data("value");"undefined"!=typeof this.form_vars[i].submit_text[c]&&(n=c,s=this.form_vars[i].submit_text[c])}}r.val(s),r.data("type",n)},this.prevent_enter_step_listener=function(t){e(t).keypress(function(e){e.keyCode||e.which;13==e.which&&e.preventDefault()})},this.call_hook=function(e,t){var a=window[e];"function"==typeof a&&(t=t||{},a(t))},this.stripe_response_handler=function(a,i){var r=e(".ezfc-form[data-id='"+t.payment_form_id+"']"),n=e(".ezfc-payment-form[data-form_id='"+t.payment_form_id+"']");if(i.error)t.debug_message(i.error.message),e("#ezfc-payment-message-"+t.payment_form_id).text(i.error.message),n.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!1),setTimeout(function(){e("#ezfc-payment-message-"+t.payment_form_id).text("")},7500);else{var s=i.id;r.find("#ezfc-stripetoken-"+t.payment_form_id).val(s),t.form_submit(r,-1,"stripe-checkout")}},this.authorize_create_token=function(a){var i={};authData={},cardData={};e("#ezfc-authorize-form-"+a);cardData.cardNumber=e("#ezfc-element-payment-authorize-card-number-"+a).val(),cardData.cardNumber=cardData.cardNumber.replace(/ /g,""),cardData.month=e("#ezfc-element-payment-authorize-expiry-month-"+a).val(),cardData.year=e("#ezfc-element-payment-authorize-expiry-year-"+a).val(),cardData.cardCode=e("#ezfc-element-payment-authorize-cvc-"+a).val(),i.cardData=cardData,authData.clientKey=ezfc_vars.authorize.client_key,authData.apiLoginID=ezfc_vars.authorize.api_login_id,i.authData=authData,Accept.dispatchData(i,t.authorize_response_handler)},this.authorize_response_handler=function(a){var i=e(".ezfc-form[data-id='"+t.payment_form_id+"']"),r=e(".ezfc-payment-form[data-form_id='"+t.payment_form_id+"']"),n=i.data("id");if("Error"===a.messages.resultCode){r.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!1);for(var s=[],o=0;o<a.messages.message.length;o++)s.push(a.messages.message[o].text),t.debug_message(a.messages.message[o].code+": "+a.messages.message[o].text);t.set_message(n,s.join(" "))}else{var c=a.opaqueData.dataValue;e("#ezfc-authorizetoken-"+t.payment_form_id).val(c),t.form_submit(i,-1,"authorize-checkout")}},this.check_datepicker_days=function(t,a,i){t.setHours(0,0,0,0);var r=t.getTime();if(i.length)for(var n in i){var s=-1!==i[n].indexOf(":");if(s){var o=i[n].split(":");if(2==o.length){var c=new Date(o[0]),l=new Date(o[1]);if(r>=c.getTime()&&r<=l.getTime())return[!1,""]}}else{var d=new Date(i[n]);if(r==d.getTime())return[!1,""]}}var f=t.getDay();return[-1!==e.inArray(f,a),""]},this.get_target_subtotal_value=function(e,t,a){for(var i in this.subtotals[e])if(this.subtotals[e][i].el_id==t)return a?"undefined"!=typeof this.subtotals[e][i-1]?this.subtotals[e][i-1].price:0:this.subtotals[e][i].price;return null},this.get_calculated_element_value=function(t,a){var i=e("#ezfc-form-"+t),r=e("#ezfc_element-"+a),n=r.data("element"),s=this.calculate_element_loop(t,r,n,0);return s=this.calculate_discounts(i,t,r,n,s)},this.set_message=function(t,a){var i=e("#ezfc-form-"+t);if(!i)return!1;var r,n=i.closest(".ezfc-wrapper");return r=n.find(".ezfc-payment-dialog-open").length>0?n.find(".ezfc-payment-errors"):i.parents(".ezfc-wrapper").find(".ezfc-message"),!r.length&&console?(console.log(a),!1):void r.text(a).fadeIn().delay(7500).fadeOut()},this.recaptcha_reload=function(){var t=e(".ezfc-form .g-recaptcha").length;t&&"undefined"!=typeof grecaptcha&&grecaptcha.reset()},this.populate_html_placeholders=function(a){a.find(".ezfc-html-placeholder").each(function(i,r){var n=e(r),s="",o=t.functions.get_element_id_by_name(a.data("id"),n.data("listen_target"));if(o){var c=n.data("listen_retrieve");s=t.get_value_from_element(!1,o,!0,!1,{return_value:c}),"object"==typeof s&&(s=s.join(", ")),s=e.trim(s),n.text(s)}})},this.group_repeat=function(a){"undefined"==typeof this.group_repeat_elements[a]&&(this.group_repeat_elements[a]=0),this.group_repeat_elements[a]++;var i=e("#ezfc_element-"+a),r=i.clone(!0),n=i.closest(".ezfc-form");r.find(".ezfc-group-repeatable-wrapper").remove(),r.insertAfter(i).attr("id",r.attr("id")+this.group_repeat_elements[a]),r.find("[id^='ezfc_element-']").each(function(){var i=e(this).attr("id"),r=i+"-"+t.group_repeat_elements[a],n=e(this).data("id")+"-"+t.group_repeat_elements[a];e(this).attr("id",r),e(this).data("id",n)}),this.form_change(n)},this.toggle_group=function(e,t){var a=e.find("> .ezfc-group-elements").first();if(e.hasClass("ezfc-group-collapsible")){a.slideToggle(500);var i="ezfc-group-active",r="fa-chevron-circle-down",n="fa-chevron-circle-right",s=e.find(".ezfc-collapse-icon i").first();s.hasClass(r)&&!t?(s.removeClass(r).addClass(n),e.removeClass(i)):(s.removeClass(n).addClass(r),e.addClass(i))}},this.show_tip=function(e,t,a,i){var r=new Opentip(e,{background:ezfc_vars.opentip.background||"yellow",delay:a,hideDelay:.1,hideTriggers:["closeButton","target"],removeElementsOnHide:!0,showOn:null,target:t,tipJoint:ezfc_vars.required_text_position||"middle right"});r.setContent(i),r.show()},this.submit_cancel=function(e){var a=e.closest(".ezfc-wrapper"),i=e.find("input[type='submit']"),r=e.find(".ezfc-submit-icon"),n=e.data("id");r.fadeOut(),i.prop("disabled",!1),a.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!1);for(var s in this.payment_methods){var o=t.payment_methods[s];t.form_vars[n].payment_info_shown[o]=0}},this.remove_debug_info=function(){e(".ezfc-debug-info").remove()},this.add_debug_info=function(t,a,i){if(2==ezfc_vars.debug_mode&&(t=t||e(a).data("element"),"group"!=t)){var r=e(a).attr("id");r&&(r=r.split("ezfc_element-")[1]);var n="ezfc-debug-"+r,s=e("#"+n).length;if("custom_calculation"!=t||!s){var o="[["+t+" #"+r+"]]\n["+t+"]\n"+i+"\n\n";s?e(a).find(".ezfc-debug-info").append(o):e(a).append("<pre id='"+n+"' class='ezfc-debug-info ezfc-debug-type-"+t+"'>"+o+"</pre>"),console.log(i,a)}}},this.debug_message=function(e){0!=ezfc_vars.debug_mode&&console.log(e)},this.jqueryui_date_diff=function(e,t,a){if(!e||!t)return 0;var i=0;if(a){var r,n,s=function(e,t,a){return e==t?a:e};r=t-e,r/=864e5,daysBeforeFirstSunday=(7-e.getDay())%7,n=t.getDay(),r-=daysBeforeFirstSunday+n,r=r/7*5,r+=s(daysBeforeFirstSunday-1,-1,0)+s(n,6,5),i=r}else i=(t-e)/1e3/60/60/24;return i=Math.ceil(i)},this.roundTo=function(e,t){var a=Math.pow(10,t),i=e*a,r=Math.round(i);return r/a},this.sprintf=function(){var e=arguments,t=e[0],a=1;return t.replace(/%((%)|s|d)/g,function(t){var i=null;if(t[2])i=t[2];else{switch(i=e[a],t){case"%d":i=parseFloat(i),isNaN(i)&&(i=0)}a++}return i})},this.throttle=function(e,t,a){t=t||(t=100);var i,r;return function(){var n=a||this,s=+new Date,o=arguments;i&&i+t>s?(clearTimeout(r),r=setTimeout(function(){i=s,e.apply(n,o)},t)):(i=s,e.apply(n,o))}},this.init()},ezfc_functions={};var EZFC;jQuery(document).ready(function(e){EZFC=new EZFC_Object(e)});